	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	MOVE.L #PRG,P_START
	MOVE.L #EPRG,P_END
	MOVE.L #PRG,P_PACK
	BSR CRUNCH
	CLR.L -(A7)
	TRAP #1
CRUNCH	MOVEA.L	P_START,A0
	MOVEA.L	P_PACK,A2
	MOVEA.L	P_END,A1
	MOVEQ	#1,D2
	CLR.W	D1
	MOVEQ	#0,D7
LD7F6	BSR.S	LD844
	TST.B	D0
	BEQ.S	LD808
	ADDQ.W	#1,D1
	CMPI.W	#$108,D1
	BNE.S	LD808
	BSR	LD906
LD808	CMPA.L	A0,A1
	BGT.S	LD7F6
	BSR	LD906
	BSR	LD940
	MOVE.L	D7,(A2)+
	MOVE.L P_PACK,D1
	MOVE.L P_END,D2
	SUB.L D1,D2
	MOVE.L	D2,(A2)+
	MOVE.L #'JEK!',(A2)+
	RTS
LD844	MOVEA.L	A0,A3
	ADDA.L	TROZO,A3
	CMPA.L	A1,A3
	BLE.S	LD850
	MOVEA.L	A1,A3
LD850	MOVEQ	#1,D5
	MOVEA.L	A0,A5
	ADDQ.W	#1,A5
LD856	MOVE.B	(A0),D3
	MOVE.B	1(A0),D4
LD85C	CMP.B	(A5)+,D3
	BNE.S	LD864
	CMP.B	(A5),D4
	BEQ.S	LD86A
LD864	CMPA.L	A5,A3
	BGT.S	LD85C
	BRA.S	LD8C4
LD86A	SUBQ.W	#1,A5
	MOVEA.L	A0,A4
LD86E	MOVE.B	(A4)+,D3
	CMP.B	(A5)+,D3
	BNE.S	LD878
	CMPA.L	A5,A3
	BGT.S	LD86E
LD878	MOVE.L	A4,D3
	SUB.L	A0,D3
	SUBQ.L	#1,D3
	CMP.L	D3,D5
	BGE.S	LD8C0
	MOVE.L	A5,D4
	SUB.L	A0,D4
	SUB.L	D3,D4
	SUBQ.W	#1,D4
	CMPI.L	#4,D3
	BLE.S	LD8A2
	MOVEQ	#6,D6
	CMPI.L	#$101,D3
	BLT.S	LD8A0
	MOVE.W	#$100,D3
LD8A0	BRA.S	LD8A8
LD8A2	MOVE.W	D3,D6
	SUBQ.W	#2,D6
	LSL.W	#1,D6
LD8A8	LEA	C_DATA(PC),A6
	CMP.W	0(A6,D6.W),D4
	BGE.S	LD8C0
	MOVE.L	D3,D5
	MOVE.L	D4,DATA0
	MOVE.B	D6,DATA1
LD8C0	CMPA.L	A5,A3
	BGT.S	LD856
LD8C4	CMPI.L	#1,D5
	BEQ.S	LD8FC
	BSR.S	LD906
	MOVE.B	DATA1(PC),D6
	MOVE.L	DATA0(PC),D3
	MOVE.W	8(A6,D6.W),D0
	BSR.S	LD932
	MOVE.W	$10(A6,D6.W),D0
	BEQ.S	LD8E8
	MOVE.L	D5,D3
	SUBQ.W	#1,D3
	BSR.S	LD932
LD8E8	MOVE.W	$18(A6,D6.W),D0
	MOVE.W	$20(A6,D6.W),D3
	BSR.S	LD932
	ADDQ.W	#1,$28(A6,D6.W)
	ADDA.L	D5,A0
	CLR.B	D0
	RTS
LD8FC	MOVE.B	(A0)+,D3
	MOVEQ	#8,D0
	BSR.S	LD932
	MOVEQ	#1,D0
	RTS
LD906	TST.W	D1
	BEQ.S	LD920
	MOVE.W	D1,D3
	CLR.W	D1
	CMPI.W	#9,D3
	BGE.S	LD922
	ADDQ.W	#1,C_DATA+48
	SUBQ.W	#1,D3
	MOVEQ	#5,D0
	BRA.S	LD932
LD920	RTS
LD922	ADDQ.W	#1,C_DATA+50
	SUBI.W	#9,D3
	ORI.W	#$700,D3
	MOVEQ	#$B,D0
LD932	SUBQ.W	#1,D0
LD934	LSR.L	#1,D3
	ROXL.L	#1,D2
	BCS.S	LD942
	DBF	D0,LD934
	RTS
LD940	CLR.W	D0
LD942	MOVE.L	D2,(A2)+
	MOVE.W	D2,C_DATA+250
	EOR.L	D2,D7
	MOVEQ	#1,D2
	DBF	D0,LD934
	RTS
P_START	DS.L 1
P_END	DS.L 1
P_PACK	DS.L 1
TROZO	DC.L $1000
DATA0	DS.L 1
DATA1	DS.W 1
C_DATA	INCBIN 'DATAP.DAT'
PRG	INCBIN 'START.PRG'
EPRG
