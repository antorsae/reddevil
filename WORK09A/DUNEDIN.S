** DUNEDIN PD CATALOGUE INTRO...
** BIEN, NO ES MI MEJOR DEMO
** PERO ESTA BIEN PARA HABERLA
** HECHO EN 2 DIAS!!! 

** EL CODIGO EMPLEADO ES BASTANTE
** MALO (LENTO) Y CASI NO ESTA 
** DEPURADO, POR LO QUE NO TE ASUSTES SI
** VES ALGUNA COSA RARA...

** (C) 1990 RED DEVIL 

** (CAMBIAS EL BASE0=$F0000 Y BASE1=$F8000
** POR $60000 Y $68000 RESPECTIVAMENTE...)


MAX	EQU 320-16
MAY	EQU 133-7
XYINC	EQU $00030001 ;Y,X
XYINK	EQU $00070004 ;Y,X
BASE0	EQU $F0000
BASE1	EQU $F8000
	PEA MAINPR(PC)
	MOVE.W #$26,-(A7)
	TRAP #14 ;PARA NO CAMBIAR EL SP!
	ADDQ.L #6,A7
	CLR.L -(A7)
	TRAP #1
MAINPR	BSR PCOLS
	BSR LOADTE
	BSR ROXRED
	BSR GENSIN
	BSR ROXDUA
	BSR SETWAV
	BSR WATRA
	BSR STEXTBL
	BSR ROXFONT
	BSR SCAWAZ
	BSR CLS
	BSR SMUS
	BSR SINT
	MOVEM.L FILE+4,D1-D7
	MOVEM.L D1-D7,$FFFF8240+4.W
	CLR.L $FFFF8240.W
WAIT	CLR.B SYNC
VSYNC	TST.B SYNC
	BEQ.S VSYNC
	BSR GOHBL
	JSR MUZAK+4+4
	BSR TGGSC
	BSR WAVEF
	BSR BSC16
	BSR GOBOR
	BSR CALCTR
	BSR PUTSPR
	BSR BOSPR
	CMP.B #$39,$FFFFFC02.W
	BNE.S WAIT
	BSR GINT
	LEA $FFFF8800.W,A0
	MOVE.L #$8080000,(A0)
	MOVE.L #$9090000,(A0)
	MOVE.L #$A0A0000,(A0)
	BSR CLS
	MOVEM.L OLDCOL,D0-D7
	MOVEM.L D0-D7,$FFFF8240.W
	RTS
SINT	LEA INTS(PC),A0
	MOVE.W #$2700,SR
	MOVE.L $70.W,(A0)+
	MOVE.L $120.W,(A0)+
	MOVE.B $FFFFFA07.W,(A0)+
	MOVE.B $FFFFFA09.W,(A0)+
	MOVE.B $FFFFFA13.W,(A0)+
	MOVE.B $FFFF8203.W,(A0)+
	MOVE.B $FFFF8201.W,(A0)+
	MOVE.L #VBL,$70.W
	MOVE.L #HBL,$120.W
	CLR.B $FFFFFA07.W
	CLR.B $FFFFFA09.W
	CLR.B $FFFFFA1B.W
	MOVE.B #1,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	OR.B #1,$FFFFFA07.W
	OR.B #1,$FFFFFA13.W
	MOVE.W #$2300,SR
	RTS
GINT	CLR.B SYNC
CVSYNC	TST.B SYNC
	BEQ.S CVSYNC
	LEA INTS(PC),A0
	MOVE.W #$2700,SR
	MOVE.L (A0)+,$70.W
	MOVE.L (A0)+,$120.W
	MOVE.B (A0)+,$FFFFFA07.W
	MOVE.B (A0)+,$FFFFFA09.W
	MOVE.B (A0)+,$FFFFFA13.W
	MOVE.B (A0)+,$FFFF8203.W
	MOVE.B (A0)+,$FFFF8201.W
	MOVE.W #$2300,SR
	RTS
VBL	ST SYNC
	MOVE.L #HBLESP+2,HBLDIR
	MOVE.W HBLESP,$FFFF8242.W
	RTE
HBL	MOVE.L A0,-(A7)
	MOVEA.L HBLDIR,A0
	MOVE.W (A0),$FFFF8242.W
	ADDQ.L #2,HBLDIR
	MOVE.L (A7)+,A0
	BCLR #0,$FFFFFA0F.W
	RTE
OLDCOL	DS.W 16
INTS	DS.L 4
SYNC	DS.W 1
CLS	LEA BASE0,A1
	LEA BASE1+32000,A2
LKJ	CLR.L (A1)+
	CMPA.L A1,A2
	BGT.S LKJ
	RTS
TGGSC	MOVE.L SCREEN,D0
	BCHG #15,D0
	MOVE.L D0,SCREEN
	LSR.L #8,D0
	MOVE.B D0,$FFFF8203.W
	LSR.W #8,D0
	MOVE.B D0,$FFFF8201.W
	RTS
SCREEN	DC.L BASE1
PCOLS	MOVEM.L $FFFF8240.W,D0-D7
	MOVEM.L D0-D7,OLDCOL
	MOVEQ #0,D0
	LEA $FFFF8240.W,A0
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D0,(A0)
	RTS
SCAWAZ	LEA WAXL(PC),A0
	MOVEQ #1,D0
LOKJHG	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S SWWW
	MOVE.W #-1,(A0)
	RTS
SWWW	ADD.W D1,D0
	MOVE.W D0,(A0)+
	BRA.S LOKJHG
GOHBL	MOVEQ #0,D0
	MOVEQ #0,D2
	LEA HBLCOL(PC),A0
	LEA HBLESP(PC),A1
	LEA (A1),A2
	MOVEQ #(200/8)-1,D6
D6LOP	MOVE.L D2,(A2)+
	MOVE.L D2,(A2)+
	MOVE.L D2,(A2)+
	MOVE.L D2,(A2)+
	DBF D6,D6LOP	
	MOVE.W PHBL,D0
	ADD.W D0,D0
	LEA 0(A1,D0.W),A1
	MOVEQ #(96/8)-1,D1
D1LKK	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	DBF D1,D1LKK
	MOVE.W #200*2,D3
	MOVE.W PHBL,D0
	LSR.W #1,D0
	ADD.W D0,D0
	SUB.W D0,D3
	LEA HBLESP(PC),A1
	LEA HBLREX(PC),A0
	LEA 0(A1,D3.W),A1
	MOVEQ #(95/8)-1,D0
D0LK	MOVE.W (A0)+,-(A1)
	MOVE.W (A0)+,-(A1)
	MOVE.W (A0)+,-(A1)
	MOVE.W (A0)+,-(A1)
	DBF D0,D0LK
	MOVE.W (A0)+,-(A1)
	MOVE.W (A0)+,-(A1)
	MOVE.W (A0)+,-(A1)
	MOVE.W D2,-(A1)
	RTS 
PHBL	DS.W 1
SMUS	MOVEQ #0,D0
	JSR MUZAK
	RTS
LOADTE	CLR.W -(A7)
	PEA TNAME
	MOVE.W #$3D,-(A7)
	TRAP #1
	ADDQ.L #8,A7
	MOVE.W D0,-(A7)
	PEA EFIN
	PEA $FFFFF
	MOVE.W D0,-(A7)
	MOVE.W #$3F,-(A7)
	TRAP #1
	LEA 12(A7),A7
	MOVE.W D0,TREAD
	MOVE.W #$3E,-(A7)
	TRAP #1
	ADDQ.L #4,A7
	RTS
BSC16	MOVEA.L SCREEN,A3
	LEA (200*160)(A3),A5
	ADDQ.L #2,CAWA
	MOVEA.L CAWA,A0
	MOVEQ #0,D0
	MOVE.W (A0)+,D0
	BPL.S WAOKL
	MOVE.L #WAXL,CAWA
	MOVE.W WAXL,D0
WAOKL	MOVE.W D0,PHBL
	MOVE.W D0,D1
	MULU #160,D1
	LEA 0(A3,D1.W),A3
	LSR.W #1,D0
	MULU #160,D0
	NEG.W D0
	LEA 0(A5,D0.W),A5
	MOVE.L CTEXT,A4
	MOVEQ #0,D5
NREST	MOVE.W PASO,D4
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTO	MOVE.W D4,D0
	LEA 0(A0,D1.W),A0
ANCH	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	MOVE.W D6,(A5)
	MOVE.W D6,-160*1(A5)
	MOVE.W D6,-160*2(A5)
	ADDQ.L #8,A3
	ADDQ.L #8,A5
	DBF D0,ANCH
	LEA (160*6)(A3),A3
	LEA (-160*3)(A5),A5
	SUBA.W D3,A3
	SUBA.W D3,A5
	DBF D2,ALTO
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	LSL.W #3,D4
	MOVE.W D4,D0
	ADD.W #(-160*16*6)+8,D4
	ADD.W #(160*16*3)+8,D0
	LEA 0(A3,D4.W),A3
	LEA 0(A5,D0.W),A5
	MOVE.W PASO,D0
	MOVEQ #20,D4
	SUB.W D0,D4
	CMP.W #16,D4
	BLE.S DOSLE
	MOVEQ #-1,D5
	MOVEQ #16,D4
DOSLE	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTOO	MOVE.W D4,D0
ANCHO	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	MOVE.W D6,(A5)
	MOVE.W D6,-160*1(A5)
	MOVE.W D6,-160*2(A5)
	ADDQ.L #8,A3
	ADDQ.L #8,A5
	DBF D0,ANCHO
	LEA 0(A0,D1.W),A0
	LEA (160*6)(A3),A3
	LEA (-160*3)(A5),A5
	SUBA.W D3,A3
	SUBA.W D3,A5
	DBF D2,ALTOO
	TST.W D5
	BEQ.S VETEYA
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	LSL.W #3,D4
	MOVE.W D4,D0
	ADD.W #(-160*16*6)+8,D4
	ADD.W #(160*16*3)+8,D0
	LEA 0(A3,D4.W),A3
	LEA 0(A5,D0.W),A5
	MOVE.W PASO,D0
	MOVEQ #20-16,D4
	SUB.W D0,D4
	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTOOO	MOVE.W D4,D0
ANCHOO	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	MOVE.W D6,(A5)
	MOVE.W D6,-160*1(A5)
	MOVE.W D6,-160*2(A5)
	ADDQ.L #8,A3
	ADDQ.L #8,A5
	DBF D0,ANCHOO
	LEA 0(A0,D1.W),A0
	LEA (160*6)(A3),A3
	LEA (-160*3)(A5),A5
	SUBA.W D3,A3
	SUBA.W D3,A5
	DBF D2,ALTOOO
VETEYA	EOR.W #FONT2-FONT1,INCRM
	BEQ.S FINROUT
	SUBQ.W #1,PASO
	BNE.S FINROUT
	MOVE.W #16,PASO
	ADDQ.L #4,CTEXT
	MOVE.W (A4),D0
	BPL.S FINROUT
	MOVE.L INTEXT,CTEXT
FINROUT	RTS
PASO	DC.W 16
INCRM	DC.W 0
X	EQU 16
Y	EQU 16
LETRAS	EQU 40
ROXFONT	MOVE.W #(X*Y*LETRAS)-1,D6
	LEA FONT1,A0
	MOVEQ #-1,D1
COMPL	MOVE.W (A0)+,D0
	BEQ.S NORML
	MOVE.W D1,-2(A0)
NORML	DBF D6,COMPL
	LEA FONT1,A0
	LEA FONT2,A1
	MOVE.W #(Y*LETRAS)-1,D6
ROXLE	ADDQ.L #1,A1
	REPT 30 
	MOVE.B (A0)+,(A1)+
	ENDR
	ADDQ.L #1,A1
	ADDQ.L #2,A0
	DBF D6,ROXLE
	RTS
STEXTBL	LEA EFIN,A0
	MOVE.W TREAD,D0
	AND.W #%1111111111111110,D0
	ADDQ.W #4,D0
	LEA 0(A0,D0.W),A1
	MOVE.L A1,INTEXT
	MOVE.L A1,CTEXT
	REPT 3
	MOVEQ #' ',D0
	BSR.S SEEK
	MULU #16*16*2,D0
	ADD.L #FONT1,D0
	MOVE.L D0,(A1)+
	ENDR
TRASCII	MOVEQ #0,D0
	MOVE.B (A0)+,D0
	BPL.S BUSCALO
	REPT 3
	MOVEQ #' ',D0
	BSR.S SEEK
	MULU #16*16*2,D0
	ADD.L #FONT1,D0
	MOVE.L D0,(A1)+
	ENDR
	MOVE.L #-1,(A1)
	RTS
BUSCALO	BSR.S SEEK
	MULU #16*16*2,D0
	ADD.L #FONT1,D0
	MOVE.L D0,(A1)+
	BRA.S TRASCII
SEEK	MOVEQ #-1,D1
	LEA CHRSET,A2
FETCH	MOVE.B (A2)+,D2
	BMI.S NOFOUND
	ADDQ.W #1,D1
	CMP.B D0,D2
	BNE.S FETCH
NOFOUND	MOVE.W D1,D0
	RTS
ROXDUA	LEA FILE+(16*2),A0
	LEA BASE1,A1
	MOVEQ #25-1,D0
PLIN	MACRO T
	MOVE.L (A0)+,\1*8(A1)
	MOVE.W (A0)+,(\1*8)+4(A1)
	ENDM
PLO	PLIN 0
	PLIN 1
	PLIN 2
	PLIN 3
	PLIN 4
	PLIN 5
	PLIN 6
	PLIN 7
	PLIN 8
	PLIN 9
	PLIN 10
	PLIN 11
	PLIN 12
	MOVE.L #0,13*8(A1)
	MOVE.W #0,(13*8)+4(A1)
	LEA 160(A1),A1
	DBF D0,PLO
	LEA ROXDUN(PC),A1
	MOVEQ #16-1,D7
VECS	BSR SALVADU
	BSR ROTADU
	DBF D7,VECS
	RTS
SALVADU	LEA BASE1,A0
	MOVEQ #25-1,D0
D0LOPK	
SLONG	MACRO TR
 	MOVE.L \1*8(A0),(A1)+
	ENDM
SWORD	MACRO TR
 	MOVE.W (\1*8)+4(A0),(A1)+
	ENDM
	SLONG 0
	SLONG 1
	SLONG 2
	SLONG 3
	SLONG 4
	SLONG 5
	SLONG 6
	SLONG 7
	SLONG 8
	SLONG 9
	SLONG 10
	SLONG 11
	SLONG 12
	SLONG 13
	SWORD 0 
	SWORD 1
	SWORD 2
	SWORD 3
	SWORD 4
	SWORD 5
	SWORD 6
	SWORD 7
	SWORD 8
	SWORD 9
	SWORD 10
	SWORD 11
	SWORD 12
	SWORD 13
	LEA 160(A0),A0
	DBF D0,D0LOPK
	RTS
ROTADU	LEA BASE1,A0
	MOVEQ #25-1,D0
D0LOPR	MOVEQ #3-1,D1
D1LOPR	MOVE.W #0,CCR
	ROXR (A0)
	ROXR 8*1(A0)
	ROXR 8*2(A0)
	ROXR 8*3(A0)
	ROXR 8*4(A0)
	ROXR 8*5(A0)
	ROXR 8*6(A0)
	ROXR 8*7(A0)
	ROXR 8*8(A0)
	ROXR 8*9(A0)
	ROXR 8*10(A0)
	ROXR 8*11(A0)
	ROXR 8*12(A0)
	ROXR 8*13(A0)
	ADDQ.L #2,A0
	DBF D1,D1LOPR
	LEA (-3*2)+160(A0),A0
	DBF D0,D0LOPR
	RTS
SETWAV	LEA WAVES(PC),A0
	MOVEQ #0,D0
LOKLP	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S NOHAF
	MOVEQ #25-1,D0
	LEA WAVES(PC),A1
COPRI	MOVE.W (A1)+,(A0)+
	DBF D0,COPRI
	MOVE.W #-1,(A0)
	RTS
NOHAF	ADD.W D1,D0	
	MOVE.L D0,D2
	DIVU #16,D2
	CLR.W D2
	SWAP D2
	MULU #25*6*14,D2
	MOVE.W D2,(A0)+
	BRA.S LOKLP
WAVEF	MOVEA.L SCREEN,A2
	LEA 199*160(A2),A4
	ADDQ.L #2,COND
	MOVEA.L COND,A0
	MOVEQ #0,D0
	MOVE.W (A0),D0
	BPL.S GILPO
	MOVE.L #ONDPOS,COND
	MOVE.W ONDPOS,D0
GILPO	MOVE.L D0,D1
	MULU #160,D1
	LEA 2+(3*8)(A2,D1.W),A2
	LSR.W #1,D0
	MULU #160,D0
	NEG.W D0
	LEA 2+(3*8)(A4,D0.W),A4
	ADDQ.L #2,CWAX
	MOVEA.L CWAX,A0
	LEA ROXDUN(PC),A1
	MOVEQ #12-1,D7
D7LOP	MOVE.W (A0)+,D0
	LEA 0(A1,D0.W),A3
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,(A2)
	MOVE.L D1,8*1(A2)
	MOVE.L D2,8*2(A2)
	MOVE.L D3,8*3(A2)
	MOVE.L D4,8*4(A2)
	MOVE.L D5,8*5(A2)
	MOVE.L D6,8*6(A2)
	MOVE.L D0,(A4)
	MOVE.L D1,8*1(A4)
	MOVE.L D2,8*2(A4)
	MOVE.L D3,8*3(A4)
	MOVE.L D4,8*4(A4)
	MOVE.L D5,8*5(A4)
	MOVE.L D6,8*6(A4)
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,8*7(A2)
	MOVE.L D1,8*8(A2)
	MOVE.L D2,8*9(A2)
	MOVE.L D3,8*10(A2)
	MOVE.L D4,8*11(A2)
	MOVE.L D5,8*12(A2)
	MOVE.L D6,8*13(A2)
	MOVE.L D0,8*7(A4)
	MOVE.L D1,8*8(A4)
	MOVE.L D2,8*9(A4)
	MOVE.L D3,8*10(A4)
	MOVE.L D4,8*11(A4)
	MOVE.L D5,8*12(A4)
	MOVE.L D6,8*13(A4)
PTRE	MACRO TR
	MOVE.W (A3)+,D0
	MOVE.W D0,(8*\1)+4(A2)
	MOVE.W D0,(8*\1)+4(A4)
	ENDM
	PTRE 0
	PTRE 1
	PTRE 2
	PTRE 3
	PTRE 4
	PTRE 5
	PTRE 6
	PTRE 7
	PTRE 8
	PTRE 9
	PTRE 10
	PTRE 11
	PTRE 12
	PTRE 13
	LEA 160(A2),A2
	LEA 14*6(A1),A1
	MOVE.W (A0)+,D0
	LEA 0(A1,D0.W),A3
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,(A2)
	MOVE.L D1,8*1(A2)
	MOVE.L D2,8*2(A2)
	MOVE.L D3,8*3(A2)
	MOVE.L D4,8*4(A2)
	MOVE.L D5,8*5(A2)
	MOVE.L D6,8*6(A2)
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,8*7(A2)
	MOVE.L D1,8*8(A2)
	MOVE.L D2,8*9(A2)
	MOVE.L D3,8*10(A2)
	MOVE.L D4,8*11(A2)
	MOVE.L D5,8*12(A2)
	MOVE.L D6,8*13(A2)
PTR	MACRO TR
	MOVE.W (A3)+,(8*\1)+4(A2)
	ENDM
	PTR 0
	PTR 1
	PTR 2
	PTR 3
	PTR 4
	PTR 5
	PTR 6
	PTR 7
	PTR 8
	PTR 9
	PTR 10
	PTR 11
	PTR 12
	PTR 13
	LEA 160(A2),A2
	LEA -160(A4),A4
	LEA 14*6(A1),A1
	DBF D7,D7LOP
	MOVE.W (A0)+,D0
	LEA 0(A1,D0.W),A3
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,(A2)
	MOVE.L D1,8*1(A2)
	MOVE.L D2,8*2(A2)
	MOVE.L D3,8*3(A2)
	MOVE.L D4,8*4(A2)
	MOVE.L D5,8*5(A2)
	MOVE.L D6,8*6(A2)
	MOVE.L D0,(A4)
	MOVE.L D1,8*1(A4)
	MOVE.L D2,8*2(A4)
	MOVE.L D3,8*3(A4)
	MOVE.L D4,8*4(A4)
	MOVE.L D5,8*5(A4)
	MOVE.L D6,8*6(A4)
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,8*7(A2)
	MOVE.L D1,8*8(A2)
	MOVE.L D2,8*9(A2)
	MOVE.L D3,8*10(A2)
	MOVE.L D4,8*11(A2)
	MOVE.L D5,8*12(A2)
	MOVE.L D6,8*13(A2)
	MOVE.L D0,8*7(A4)
	MOVE.L D1,8*8(A4)
	MOVE.L D2,8*9(A4)
	MOVE.L D3,8*10(A4)
	MOVE.L D4,8*11(A4)
	MOVE.L D5,8*12(A4)
	MOVE.L D6,8*13(A4)
	PTRE 0
	PTRE 1
	PTRE 2
	PTRE 3
	PTRE 4
	PTRE 5
	PTRE 6
	PTRE 7
	PTRE 8
	PTRE 9
	PTRE 10
	PTRE 11
	PTRE 12
	PTRE 13
	CMP.W #-1,(A0)
	BNE.S SALTE
	MOVE.L #WAVES,CWAX
N	EQU 6
SALTE	LEA 160(A2),A2
	MOVEQ #0,D0
	MOVEQ #2,D2
VEXZ	MOVEQ #N-1,D1
BLIT	MACRO TR
	MOVE.L D0,\1*8(A2)
	MOVE.W D0,(\1*8)+4(A2)
	ENDM
BOLIK	BLIT 0
	BLIT 1
	BLIT 2
	BLIT 3
	BLIT 4 
	BLIT 5
	BLIT 6
	BLIT 7
	BLIT 8
	BLIT 9
	BLIT 10
	BLIT 11
	BLIT 12
	BLIT 13
	LEA 160(A2),A2
	DBF D1,BOLIK
	LEA -160*((N*2)+25)(A2),A2
	DBF D2,VEXZ
N1	EQU 3
	LEA -160(A4),A2
	MOVEQ #2,D2
VEXZX	MOVEQ #N1-1,D1
BOLIKX	BLIT 0
	BLIT 1
	BLIT 2
	BLIT 3
	BLIT 4 
	BLIT 5
	BLIT 6
	BLIT 7
	BLIT 8
	BLIT 9
	BLIT 10
	BLIT 11
	BLIT 12
	BLIT 13
	LEA -160(A2),A2
	DBF D1,BOLIKX
	LEA 160*((N1*2)+12)(A2),A2
	DBF D2,VEXZX
	RTS
WATRA	LEA ONDPOS(PC),A0
	MOVEQ #0,D0
LOPKIJ	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S NOSCH
	MOVE.W #-1,(A0)
	RTS
NOSCH	ADD.W D1,D0
	MOVE.W D0,(A0)+
	BRA.S LOPKIJ
XPOS	DC.W 0
YPOS	DC.W 0
XREL	DC.W 0
YREL	DC.W 0
PUTSPR	LEA TRAY(PC),A0
	LEA TRAYR(PC),A6
	MOVEQ #9-1,D7
SPRT	MOVE.L (A0)+,A1
	MOVE.L (A0)+,A2
	MOVE.L (A6)+,A4
PPART	MACRO LI,L1	
	MOVE.W \1*160(A2),D0
	MOVE.L (\1*160)+2(A2),D1
	MOVE.L (A1)+,D2
	AND.W D2,D0
	AND.L D2,D1
	MOVE.W (A1)+,D3
	OR.W D3,D0
	MOVE.L D1,(\1*160)+2(A2)
	MOVE.W D0,\1*160(A2)
	MOVE.L \2*160(A4),D0
	MOVE.W (\2*160)+4(A4),D1
	AND.L D2,D0
	AND.W D2,D1
	OR.W D3,D1
	MOVE.L D0,(\2*160)(A4)
	MOVE.W D1,(\2*160)+4(A4)
	MOVE.W (\1*160)+8(A2),D0
	MOVE.L ((\1*160))+2+8(A2),D1
	MOVE.L (A1)+,D2
	AND.W D2,D0
	AND.L D2,D1
	MOVE.W (A1)+,D3
	OR.W D3,D0
	MOVE.L D1,(\1*160)+2+8(A2)
	MOVE.W D0,(\1*160)+8(A2)
	MOVE.L (\2*160)+8(A4),D0
	MOVE.W (\2*160)+8+4(A4),D1
	AND.L D2,D0
	AND.W D2,D1
	OR.W D3,D1
	MOVE.W D1,(\2*160)+8+4(A4)
	MOVE.L D0,(\2*160)+8(A4)
	ENDM
PART	MACRO LI	
	MOVE.W \1*160(A2),D0
	MOVE.L (\1*160)+2(A2),D1
	MOVE.L (A1)+,D2
	AND.W D2,D0
	AND.L D2,D1
	OR.W (A1)+,D0
	MOVE.L D1,(\1*160)+2(A2)
	MOVE.W D0,\1*160(A2)
	MOVE.W (\1*160)+8(A2),D0
	MOVE.L ((\1*160))+2+8(A2),D1
	MOVE.L (A1)+,D2
	AND.W D2,D0
	AND.L D2,D1
	OR.W (A1)+,D0
	MOVE.L D1,(\1*160)+2+8(A2)
	MOVE.W D0,(\1*160)+8(A2)
	ENDM
	PPART 0,0
	PART 1
	PPART 2,-1
	PART 3
	PPART 4,-2
	PART 5
	PPART 6,-3
	DBF D7,SPRT
	RTS
GOBOR	LEA BORR(PC),A1
	LEA TRAY+4(PC),A0
	MOVE.L (A0),(A1)+
	MOVE.L 8*1(A0),(A1)+
	MOVE.L 8*2(A0),(A1)+
	MOVE.L 8*3(A0),(A1)+
	MOVE.L 8*4(A0),(A1)+
	MOVE.L 8*5(A0),(A1)+
	MOVE.L 8*6(A0),(A1)+
	MOVE.L 8*7(A0),(A1)+
	MOVE.L 8*8(A0),(A1)+
	LEA TRAYR(PC),A0
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	MOVE.L (A0),(A1)
	RTS
BOSPR	LEA BORR(PC),A0
	MOVEQ #0,D7
	MOVEQ #9-1,D0
BORED	MOVEA.L (A0)+,A1
BOLI	MACRO LI
	MOVE.W D7,\1*160(A1)
	MOVE.W D7,(\1*160)+8(A1)
	ENDM
	BOLI 0
	BOLI 1
	BOLI 2
	BOLI 3
	BOLI 4
	BOLI 5
	BOLI 6
	DBF D0,BORED
	MOVEQ #9-1,D0
BOREDD	MOVEA.L (A0)+,A1
BOL	MACRO LI
	MOVE.W D7,(\1*160)+4(A1)
	MOVE.W D7,(\1*160)+8+4(A1)
	ENDM
	BOL 0
	BOL -1
	BOL -2
	BOL -3
	DBF D0,BOREDD
	RTS	
TRAY	REPT 9
	DC.L LE1
	DC.L BASE0+2
	ENDR
TRAYR	REPT 9
	DC.L BASE0+2
	ENDR
BORR	DS.L 18
ROXRED	LEA FILE+(16*2)+(25*13*6),A0
	LEA ROXLETS,A1
	LEA BASE0,A2
	MOVEQ #0,D7
	MOVEQ #8-1,D0
RLETRAS	BSR PRINTLE
	MOVEQ #16-1,D1
RRLETR	BSR SALVALE
	BSR ROTALA
	DBF D1,RRLETR
	DBF D0,RLETRAS
	RTS
PRINTLE	MOVE.W (A0)+,(A2)
	MOVE.W (A0)+,1*160(A2)
	MOVE.W (A0)+,2*160(A2)
	MOVE.W (A0)+,3*160(A2)
	MOVE.W (A0)+,4*160(A2)
	MOVE.W (A0)+,5*160(A2)
	MOVE.W (A0)+,6*160(A2)
	MOVE.W D7,(160*0)+8(A2)
	MOVE.W D7,(160*1)+8(A2)
	MOVE.W D7,(160*2)+8(A2)
	MOVE.W D7,(160*3)+8(A2)
	MOVE.W D7,(160*4)+8(A2)
	MOVE.W D7,(160*5)+8(A2)
	MOVE.W D7,(160*6)+8(A2)
	RTS
SALVALE	
PLETRA	MACRO LI
	MOVE.W \1*160(A2),D5
	MOVE.W D5,4(A1)
	NOT.W D5
	MOVE.W D5,(A1)
	MOVE.W D5,2(A1)
	ADDQ.L #6,A1
	MOVE.W (\1*160)+8(A2),D5
	MOVE.W D5,4(A1)
	NOT.W D5
	MOVE.W D5,(A1)
	MOVE.W D5,2(A1)
	ADDQ.L #6,A1
	ENDM
	PLETRA 0
	PLETRA 1
	PLETRA 2
	PLETRA 3
	PLETRA 4
	PLETRA 5
	PLETRA 6
	RTS
ROTALA	MOVE.W #0,CCR
PROTLE	MACRO LI
	ROXR \1*160(A2)
	ROXR (\1*160)+8(A2)
	ENDM
	PROTLE 0
	PROTLE 1
	PROTLE 2
	PROTLE 3
	PROTLE 4
	PROTLE 5
	PROTLE 6
	RTS
GENSIN	LEA SINUS,A0
	MOVE.W #MAX-1,D0
GENY	MOVEQ #0,D1
	MOVE.W (A0),D1
	MULU #160,D1
	MOVE.W D1,(A0)
	ADDQ.L #4,A0
	DBF D0,GENY
	MOVE.W #MAY-1,D0
GENX	MOVEQ #0,D1
	MOVE.W (A0),D1
	DIVU #16,D1
	LSL.W #3,D1
	MOVE.W D1,(A0)+
	CLR.W D1
	SWAP D1
	MULU #7*2*6,D1
	MOVE.W D1,(A0)+
	DBF D0,GENX
	RTS
CALCTR	LEA TRAY(PC),A0
	LEA TRAYR(PC),A4
	LEA SINUS(PC),A3
	MOVE.L SCREEN,D2
	ADDQ.L #2,D2
	MOVE.L D2,D5
	ADD.W #(199*160),D5
	ADD.L #XYINC*4,XPOS
PLE	MACRO COSA 
	MOVE.L D5,D7
	BSR CALC2
	ADD.L #\1,D1
	ADD.L D2,D0
	MOVE.L D1,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D7,(A4)+
	ENDM
	MOVE.L D5,D7
	BSR CALC1
	ADD.L #LE9,D1
	ADD.L D2,D0
	MOVE.L D1,(A0)+
	MOVE.L D0,(A0)+
	MOVE.L D7,(A4)+
	MOVE.L XPOS,XREL
	ADD.L #XYINK*4,XREL
	PLE LE8
	ADD.L #XYINK*4,XREL
	PLE LE7
	ADD.L #XYINK*4,XREL
	PLE LE6
	ADD.L #XYINK*4,XREL
	PLE LE5
	ADD.L #XYINK*4,XREL
	PLE LE4
	ADD.L #XYINK*4,XREL
	PLE LE3
	ADD.L #XYINK*4*2,XREL
	PLE LE2
	ADD.L #XYINK*4,XREL
	PLE LE1
	RTS
CALC1	MOVEQ #0,D0
	MOVEQ #0,D1
	MOVEQ #0,D6
	MOVE.W XPOS,D0
	CMP.W #MAX*4,D0
	BLT.S GOSINY
	SUB.W #MAX*4,D0
	MOVE.W D0,XPOS
GOSINY	LEA 0(A3,D0.W),A1
	MOVE.W YPOS,D0
	CMP.W #MAY*4,D0
	BLT.S GOSINX
	SUB.W #MAY*4,D0
	MOVE.W D0,YPOS
GOSINX	ADD.W #MAX*4,D0
	LEA 0(A3,D0.W),A2
	MOVE.W (A1),D0
	MOVE.W D0,D6
	DIVU #160,D6
	LSR.W #1,D6
	MULU #160,D6
	SUB.W D6,D7
	MOVE.W (A2)+,D4
	ADD.W D4,D0
	ADD.W D4,D7
	MOVE.W (A2),D1
	RTS
CALC2	MOVEQ #0,D0
	MOVEQ #0,D1
	MOVEQ #0,D6
	MOVE.W XREL,D0
	CMP.W #MAX*4,D0
	BLT.S GOSINY2
	SUB.W #MAX*4,D0
	MOVE.W D0,XREL
GOSINY2	LEA 0(A3,D0.W),A1
	MOVE.W YREL,D0
	CMP.W #MAY*4,D0
	BLT.S GOSINX2
	SUB.W #MAY*4,D0
	MOVE.W D0,YREL
GOSINX2	ADD.W #MAX*4,D0
	LEA 0(A3,D0.W),A2
	MOVE.W (A1),D0
	MOVE.W D0,D6
	DIVU #160,D6
	LSR.W #1,D6
	MULU #160,D6
	SUB.W D6,D7
	MOVE.W (A2)+,D4
	ADD.W D4,D0
	ADD.W D4,D7
	MOVE.W (A2),D1
	RTS
SINUS	INCBIN 'SENOSD.RED'
CWAX	DC.L WAVES
WAVES 	DC.W 0,1,1,1,2,2,2,1,1,1,0
	DC.W 0,-1,-1,-1,-2,-2,-2,-1,-1,-1,0
	DC.W 1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1
	DC.W -1,0,0,0,0,0,-1,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,0,-1,0,0,0,0,-1,0,0,0,0,0,-1
	DC.W 0,1,2,3,3,3,2,1,0
	DC.W 0,-1,-2,-3,-3,-3,-2,-1,0
	DC.W 1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
	DC.W -1,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,0,-1,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,-1
	DC.W 0,1,0,1,1,0,1,1,1,0,1,1,0,1,0
	DC.W 0,-1,0,-1,-1,0,-1,-1,-1,0,-1,-1,0,-1,0
	DC.W 55
	DS.W 25
COND	DC.L ONDPOS
ONDPOS	REPT 4
	DC.W 0
	ENDR
	REPT 6
	DC.W 1
	ENDR
	REPT 9
	DC.W 2
	ENDR
	REPT 18
	DC.W 3
	ENDR
	REPT 9
	DC.W 2
	ENDR
	REPT 6
	DC.W 1
	ENDR
	REPT 4
	DC.W 0
	ENDR
	REPT 4
	DC.W 0
	ENDR
	REPT 6
	DC.W -1
	ENDR
	REPT 9
	DC.W -2
	ENDR
	REPT 18
	DC.W -3
	ENDR
	REPT 9
	DC.W -2
	ENDR
	REPT 6
	DC.W -1
	ENDR
	REPT 4
	DC.W 0
	ENDR
	DC.W 55	
CAWA	DC.L WAXL
WAXL	DC.W 0,0,1,1,1,2,2,2,2,2,3,3,3,3,3,3,3
	DC.W -3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-1,-1,-1,0,0
	DC.W 55
ENCA	MACRO C1,C2
	DC.W \2,\1,\2,\1
	DC.W \2,\2,\2,\2
	ENDM
ENCAR	MACRO C1,C2
	DC.W \2,\1
	DC.W \2,\2
	ENDM
HBLREX	ENCA $500,$500
	ENCA $500,$500
	ENCA $500,$510
	ENCA $510,$520
	ENCA $520,$530
	ENCA $530,$540
	ENCA $540,$550
	ENCA $550,$550
	ENCA $550,$550
	ENCA $550,$551
	ENCA $551,$552
	ENCA $552,$553
HBLCOL	ENCA $700,$710
	ENCA $710,$720
	ENCA $720,$730
	ENCA $730,$740
	ENCA $740,$750
	ENCA $750,$760
	ENCA $760,$770
	ENCA $770,$771
	ENCA $771,$772
	ENCA $772,$773
	ENCA $773,$774
	ENCA $774,$775
HBLDIR	DC.L HBLESP
	DS.W 3
HBLESP	DS.W 200
BARRA0	DC.W $000,$010,$020,$030,$040,$050,$060,$070
	DC.W $170,$270,$370,$470,$570,$670,$770
	DC.W $770,$670,$570,$470,$370,$270,$170
	DC.W $070,$060,$050,$040,$030,$020,$010,$000
ROXDUN	DS.B 6*25*14*16
CHRSET	DC.B 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890?., ',-1,0
TNAME	DC.B 'SPR0.RED',0,0
TREAD	DC.W 0
INTEXT	DC.L 0
CTEXT	DC.L 0
FONT1	INCBIN 'FONT1616.BIN'
FONT2	DS.B FONT2-FONT1
MUZAK	INCBIN 'MUZEK.CYB'
FILE	INCBIN 'INTROD.BIN'
ROXLETS DS.B 7*2*16*8*6
EFIN	
LE1	EQU ROXLETS 	         ;P
LE2	EQU ROXLETS+(7*2*16*1*6) ;D
LE3	EQU ROXLETS+(7*2*16*2*6) ;L
LE4	EQU ROXLETS+(7*2*16*3*6) ;I
LE5	EQU ROXLETS+(7*2*16*4*6) ;B
LE6	EQU ROXLETS+(7*2*16*5*6) ;R
LE7	EQU ROXLETS+(7*2*16*6*6) ;A
LE8	EQU ROXLETS+(7*2*16*5*6) ;R
LE9	EQU ROXLETS+(7*2*16*7*6) ;Y
