BASE0	EQU $F0000
BASE1	EQU $F8000
LINS	EQU 228
	PEA 0
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA $2000,A7
	BSR STRAX
	MOVEQ #5-1,D0
LK1	MOVEQ #-1,D1
LK2	DBF D1,LK2
	DBF D0,LK1
	MOVEM.L $FFFF8240.W,D0-D7
	MOVEM.L D0-D7,OLDCO
	MOVE.L #BASE1,D0
	MOVE.L D0,SCREEN
	LSR.L #8,D0
	MOVE.B D0,$FFFF8203.W
	LSR.W #8,D0
	MOVE.B D0,$FFFF8201.W
	BSR SINT
	MOVEM.L LOGODAT,D0-D7
	MOVEM.L D0-D7,$FFFF8240.W
WAIT1	CLR.B SYNC
VSYNC1	TST.B SYNC
	BEQ.S VSYNC1
	BSR PLOG
	CMP.B #$39,$FFFFFC02.W
	BEQ.S VETE1
	TST.B ELOGO
	BEQ.S WAIT1
VETE1	BSR GINT
	MOVEM.L OLDCO,D0-D7
	MOVEM.L D0-D7,$FFFF8240.W
	CLR.L -(A7)
	TRAP #1
PLOG	MOVEA.L SCREEN,A1
	MOVEA.L CTRAY,A0
	ADDA.L (A0),A1
	MOVE.W 6(A0),D0
	BTST #0,D0
	BEQ.S HACX
	ST ELOGO
	RTS
HACX	LEA LOGODAT+(16*2)(PC),A0
	MOVE.W #(131/10)-1,D0
XLINE10	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,12*4*1(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,12*4*2(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*1)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*1)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*1)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*2)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*2)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*2)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*3)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*3)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*3)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*4)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*4)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*4)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*5)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*5)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*5)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*6)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*6)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*6)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*7)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*7)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*7)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*8)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*8)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*8)(A1)
	
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*0)+(160*9)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*1)+(160*9)(A1)
	MOVEM.L (A0)+,D1-D7/A2-A6
	MOVEM.L D1-D7/A2-A6,(12*4*2)+(160*9)(A1)
	
	LEA 160*10(A1),A1
	
	DBF D0,XLINE10
	ADDQ.L #4,CTRAY
	RTS
STRAX	LEA TRAYECT(PC),A0
LOKJUI	MOVEQ #0,D1
	MOVE.W (A0),D1
	BPL.S MJK
	MOVE.L #-1,(A0)
	RTS
MJK	MULU #160,D1
	ADDQ.L #8*1,D1
	MOVE.L D1,(A0)+
	BRA.S LOKJUI
SINT	LEA INTS(PC),A0
	MOVE.W #$2700,SR
	MOVE.L $70.W,(A0)+
	MOVE.L $120.W,(A0)+
	MOVE.L $134.W,(A0)+
	MOVE.B $FFFFFA07.W,(A0)+
	MOVE.B $FFFFFA09.W,(A0)+
	MOVE.B $FFFFFA13.W,(A0)+
	MOVE.B $FFFF8201.W,(A0)+
	MOVE.B $FFFF8203.W,(A0)+
	MOVE.B $FFFF820A.W,(A0)+
	MOVE.L #VBL,$70.W
	MOVE.L #HBL,$120.W
	LEA $FFFFFA00.W,A1
	CLR.B 7(A1)
	CLR.B 9(A1)
	CLR.B $1B(A1)
	MOVE.B #LINS,$21(A1)
	MOVE.B #8,$1B(A1)
	OR.B #1,7(A1)
	OR.B #1,$13(A1)
	MOVE.W #$2300,SR
	RTS
GINT	CLR.B SYNC
VSYNCR	TST.B SYNC
	BEQ.S VSYNCR
	LEA INTS(PC),A0
	MOVE.W #$2700,SR
	MOVE.L (A0)+,$70.W
	MOVE.L (A0)+,$120.W
	MOVE.L (A0)+,$134.W
	MOVE.B (A0)+,$FFFFFA07.W
	MOVE.B (A0)+,$FFFFFA09.W
	MOVE.B (A0)+,$FFFFFA13.W
	MOVE.B (A0)+,$FFFF8201.W
	MOVE.B (A0)+,$FFFF8203.W
	MOVE.B (A0)+,$FFFF820A.W
	MOVE.W #$2300,SR
	RTS
VBL	MOVE.W D7,-(A7)
	MOVE.W #$433,D7
	NOP
	NOP
LOKJ	NOP
	DBF D7,LOKJ
	MOVE.B #0,$FFFF820A.W
	REPT 3
	NOP
	ENDR
	MOVE.B #2,$FFFF820A.W
	ST SYNC
	CLR.B $FFFFFA1B.W
	MOVE.B #LINS,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.W (A7)+,D7
	RTE
HBL	MOVE.B #0,$FFFF820A.W
	REPT 3
	NOP
	ENDR
	MOVE.B #2,$FFFF820A.W
	CLR.B $FFFFFA1B.W
	BCLR #0,$FFFFFA0F.W
	RTE
INTS	DS.L 5
OLDCO	DS.W 16
SCREEN	DC.L BASE1
ELOGO	DS.B 1
SYNC	DS.B 1
CTRAY	DC.L TRAYECT
TRAYECT	INCBIN 'SENOSM.RED'
	DC.W -1,0
LOGODAT	INCBIN 'REDLOGO.BIN'

	