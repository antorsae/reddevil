BASE0	EQU $F0000
BASE1	EQU $F8000
	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA $2000,A7
	BSR ROXDUA
	BSR SETWAV
	BSR WATRA
ME	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	*MOVE.W #$700,$FFFF8240.W
	BSR WAVEF
	BSR MIRROR
	MOVE.W #$777,$FFFF8240.W
	BRA.S ME
MIRROR	MOVEA.L SCREEN,A0
	LEA (160*200)(A0),A1
	MOVEQ #66-1,D7
LOMRR	MOVEM.L 160-(12*4*1)(A0),D0-D6/A2-A6
	MOVEM.L D0-D6/A2-A6,-(A1)
	MOVEM.L 160-(12*4*2)(A0),D0-D6/A2-A6
	MOVEM.L D0-D6/A2-A6,-(A1)
	MOVEM.L 160-(12*4*3)(A0),D0-D6/A2-A6
	MOVEM.L D0-D6/A2-A6,-(A1)
	MOVEM.L (A0),D0-D3
	MOVEM.L D0-D3,-(A1)
	LEA 160*2(A0),A0
	DBF D7,LOMRR
	RTS
SCREEN	DC.L $F8000
ROXDUA	LEA FILE+(16*2),A0
	LEA BASE1,A1
	MOVEQ #25-1,D0
PLIN	MACRO T
	MOVE.L (A0)+,\1*8(A1)
	MOVE.W (A0)+,(\1*8)+4(A1)
	ENDM
PLO	PLIN 0
	PLIN 1
	PLIN 2
	PLIN 3
	PLIN 4
	PLIN 5
	PLIN 6
	PLIN 7
	PLIN 8
	PLIN 9
	PLIN 10
	PLIN 11
	PLIN 12
	MOVE.L #0,13*8(A1)
	MOVE.W #0,(13*8)+4(A1)
	LEA 160(A1),A1
	DBF D0,PLO
	LEA ROXDUN(PC),A1
	MOVEQ #16-1,D7
VECS	BSR SALVADU
	BSR ROTADU
	DBF D7,VECS
	RTS
SALVADU	LEA BASE1,A0
	MOVEQ #25-1,D0
D0LOPK	
SLONG	MACRO TR
 	MOVE.L \1*8(A0),(A1)+
	ENDM
SWORD	MACRO TR
 	MOVE.W (\1*8)+4(A0),(A1)+
	ENDM
	SLONG 0
	SLONG 1
	SLONG 2
	SLONG 3
	SLONG 4
	SLONG 5
	SLONG 6
	SLONG 7
	SLONG 8
	SLONG 9
	SLONG 10
	SLONG 11
	SLONG 12
	SLONG 13
	SWORD 0 
	SWORD 1
	SWORD 2
	SWORD 3
	SWORD 4
	SWORD 5
	SWORD 6
	SWORD 7
	SWORD 8
	SWORD 9
	SWORD 10
	SWORD 11
	SWORD 12
	SWORD 13
	LEA 160(A0),A0
	DBF D0,D0LOPK
	RTS
ROTADU	LEA BASE1,A0
	MOVEQ #25-1,D0
D0LOPR	MOVEQ #3-1,D1
D1LOPR	MOVE.W #0,CCR
	ROXR (A0)
	ROXR 8*1(A0)
	ROXR 8*2(A0)
	ROXR 8*3(A0)
	ROXR 8*4(A0)
	ROXR 8*5(A0)
	ROXR 8*6(A0)
	ROXR 8*7(A0)
	ROXR 8*8(A0)
	ROXR 8*9(A0)
	ROXR 8*10(A0)
	ROXR 8*11(A0)
	ROXR 8*12(A0)
	ROXR 8*13(A0)
	ADDQ.L #2,A0
	DBF D1,D1LOPR
	LEA (-3*2)+160(A0),A0
	DBF D0,D0LOPR
	RTS
SETWAV	LEA WAVES(PC),A0
	MOVEQ #0,D0
LOKLP	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S NOHAF
	MOVEQ #25-1,D0
	LEA WAVES(PC),A1
COPRI	MOVE.W (A1)+,(A0)+
	DBF D0,COPRI
	MOVE.W #-1,(A0)
	RTS
NOHAF	ADD.W D1,D0	
	MOVE.W D0,D2
	DIVU #16,D2
	CLR.W D2
	SWAP D2
	MULU #25*6*14,D2
	MOVE.W D2,(A0)+
	BRA.S LOKLP
WAVEF	MOVEA.L SCREEN,A2
	ADDQ.L #2,COND
	MOVEA.L COND,A0
	MOVE.W (A0),D0
	BPL.S GILPO
	MOVE.L #ONDPOS,COND
	MOVE.W ONDPOS,D0
GILPO	LEA 2+(3*8)(A2,D0.W),A2
	ADDQ.L #2,CWAX
	MOVEA.L CWAX,A0
	LEA ROXDUN(PC),A1
	MOVEQ #25-1,D7
D7LOP	MOVE.W (A0)+,D0
	LEA 0(A1,D0.W),A3
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,(A2)
	MOVE.L D1,8*1(A2)
	MOVE.L D2,8*2(A2)
	MOVE.L D3,8*3(A2)
	MOVE.L D4,8*4(A2)
	MOVE.L D5,8*5(A2)
	MOVE.L D6,8*6(A2)
	MOVEM.L (A3)+,D0-D6
	MOVE.L D0,8*7(A2)
	MOVE.L D1,8*8(A2)
	MOVE.L D2,8*9(A2)
	MOVE.L D3,8*10(A2)
	MOVE.L D4,8*11(A2)
	MOVE.L D5,8*12(A2)
	MOVE.L D6,8*13(A2)
PTR	MACRO TR
	MOVE.W (A3)+,(8*\1)+4(A2)
	ENDM
	PTR 0
	PTR 1
	PTR 2
	PTR 3
	PTR 4
	PTR 5
	PTR 6
	PTR 7
	PTR 8
	PTR 9
	PTR 10
	PTR 11
	PTR 12
	PTR 13
	LEA 160(A2),A2
	LEA 14*6(A1),A1
	DBF D7,D7LOP
	MOVE.W (A0),D0
	BPL.S SALTE
	MOVE.L #WAVES,CWAX
SALTE	MOVEQ #0,D0
	MOVEQ #2,D2
VEXZ	MOVEQ #3-1,D1
BLIT	MACRO TR
	MOVE.L D0,\1*8(A2)
	MOVE.W D0,(\1*8)+4(A2)
	ENDM
BOLIK	BLIT 0
	BLIT 1
	BLIT 2
	BLIT 3
	BLIT 4 
	BLIT 5
	BLIT 6
	BLIT 7
	BLIT 8
	BLIT 9
	BLIT 10
	BLIT 11
	BLIT 12
	BLIT 13
	LEA 160(A2),A2
	DBF D1,BOLIK
	LEA -160*(3+3+25)(A2),A2
	DBF D2,VEXZ
	RTS
WATRA	LEA ONDPOS(PC),A0
	MOVEQ #0,D0
LOPKIJ	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S NOSCH
	MOVE.W #-1,(A0)
	RTS
NOSCH	ADD.W D1,D0
	MOVE.L D0,D2
	MULU #160,D2
	ADD.W #160*3,D2
	MOVE.W D2,(A0)+
	BRA.S LOPKIJ
CWAX	DC.L WAVES
WAVES 	DC.W 0,1,1,1,2,2,2,1,1,1,0
	DC.W 0,-1,-1,-1,-2,-2,-2,-1,-1,-1,0
	DC.W 1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1
	DC.W -1,0,0,0,0,0,-1,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,0,-1,0,0,0,0,-1,0,0,0,0,0,-1
	DC.W 0,1,2,3,3,3,2,1,0
	DC.W 0,-1,-2,-3,-3,-3,-2,-1,0
	DC.W 1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
	DC.W -1,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,0,-1,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,-1
	DC.W 0,1,0,1,1,0,1,1,1,0,1,1,0,1,0
	DC.W 0,-1,0,-1,-1,0,-1,-1,-1,0,-1,-1,0,-1,0
	DC.W 0,1,2,1,3,1,3,1,2,1,0
	DC.W 0,-1,-2,-1,-3,-1,-3,-1,-2,-1,0
	DC.W 0,1,2,1,3,1,2,1,0
	DC.W 0,-1,-2,-1,-3,-1,-2,-1,0
	DC.W 0,1,2,3,3,3,2,1,0
	DC.W 0,-1,-2,-3,-3,-3,2,-1,0
	DC.W 55
	DS.W 25
COND	DC.L ONDPOS
ONDPOS	REPT 4
	DC.W 0
	ENDR
	REPT 6
	DC.W 1
	ENDR
	REPT 9
	DC.W 2
	ENDR
	REPT 18
	DC.W 3
	ENDR
	REPT 9
	DC.W 2
	ENDR
	REPT 6
	DC.W 1
	ENDR
	REPT 4
	DC.W 0
	ENDR
	REPT 4
	DC.W 0
	ENDR
	REPT 6
	DC.W -1
	ENDR
	REPT 9
	DC.W -2
	ENDR
	REPT 18
	DC.W -3
	ENDR
	REPT 9
	DC.W -2
	ENDR
	REPT 6
	DC.W -1
	ENDR
	REPT 4
	DC.W 0
	ENDR
	*DC.W 0,1,1,1,2,2,2,2,3,3,3,3,2,2,2,1,1,1,0
	*DC.W 0,-1,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-2,-2,-2,-1,-1,-1,0
	DC.W 55	
FILE	INCBIN 'INTROD.BIN'
ROXDUN