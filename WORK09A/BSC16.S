*** ROUTINA DE BIGSCROLL MUCHO MAS
*** ESTRUCTURAL QUE LAS ANTERIORES
*** 
*** FALTAN MUCHOS ARREGLOS PERO DE
*** TODAS FORMAS EL TIEMPO EMPLEADO
*** NO ES EXCESIVO. 
***
*** (C) RED DEVIL, 11 AGOSTO 1990 V.1.00

	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	BSR STEXTBL
	BSR ROXFONT
	BSR SCAWAZ
ME	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	MOVE.W #$070,$FFFF8240.W
	BSR BSC16
	MOVE.W #$777,$FFFF8240.W
	BRA.S ME
SCAWAZ	LEA WAXL(PC),A0
	MOVEQ #0,D0
LOKJHG	MOVE.W (A0),D1
	CMP.W #55,D1
	BNE.S SWWW
	MOVE.W #-1,(A0)
	RTS
SWWW	ADD.W D1,D0
	MOVE.W D0,D2
	MULU #160,D2
	MOVE.W D2,(A0)+
	BRA.S LOKJHG
BSC16	MOVEA.L SCREEN,A3
	ADDQ.L #2,CAWA
	MOVEA.L CAWA,A0
	MOVE.W (A0)+,D0
	BPL.S WAOKL
	MOVE.L #WAXL,CAWA
	MOVE.W WAXL,D0
WAOKL	LEA 0(A3,D0.W),A3
	MOVE.L CTEXT,A4
	MOVEQ #0,D5
NREST	MOVE.W PASO,D4
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTO	MOVE.W D4,D0
	LEA 0(A0,D1.W),A0
ANCH	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	ADDQ.L #8,A3
	DBF D0,ANCH
	LEA (160*6)(A3),A3
	SUBA.W D3,A3
	DBF D2,ALTO
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	LSL.W #3,D4
	ADD.W #(-160*16*6)+8,D4
	LEA 0(A3,D4.W),A3
	MOVE.W PASO,D0
	MOVEQ #20,D4
	SUB.W D0,D4
	CMP.W #16,D4
	BLE.S DOSLE
	MOVEQ #-1,D5
	MOVEQ #16,D4
DOSLE	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTOO	MOVE.W D4,D0
ANCHO	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	ADDQ.L #8,A3
	DBF D0,ANCHO
	LEA 0(A0,D1.W),A0
	LEA (160*6)(A3),A3
	SUBA.W D3,A3
	DBF D2,ALTOO
	TST.W D5
	BEQ.S VETEYA
	MOVEA.L (A4)+,A0
	ADDA.W INCRM,A0
	LSL.W #3,D4
	ADD.W #(-160*16*6)+8,D4
	LEA 0(A3,D4.W),A3
	MOVE.W PASO,D0
	MOVEQ #20-16,D4
	SUB.W D0,D4
	MOVEQ #16,D1
	SUB.W D4,D1
	ADD.W D1,D1
	MOVE.W D4,D3
	LSL.W #3,D3
	MOVEQ #16-1,D2
	SUBQ.W #1,D4
ALTOOO	MOVE.W D4,D0
ANCHOO	MOVE.W (A0)+,D6
	MOVE.W D6,(A3)
	MOVE.W D6,160*1(A3)
	MOVE.W D6,160*2(A3)
	MOVE.W D6,160*3(A3)
	MOVE.W D6,160*4(A3)
	MOVE.W D6,160*5(A3)
	ADDQ.L #8,A3
	DBF D0,ANCHOO
	LEA 0(A0,D1.W),A0
	LEA (160*6)(A3),A3
	SUBA.W D3,A3
	DBF D2,ALTOOO
VETEYA	EOR.W #FONT2-FONT1,INCRM
	BEQ.S FINROUT
	SUBQ.W #1,PASO
	BNE.S FINROUT
	MOVE.W #16,PASO
	ADDQ.L #4,CTEXT
	MOVE.W (A4),D0
	BPL.S FINROUT
	MOVE.L #TEXTL,CTEXT
FINROUT	RTS
PASO	DC.W 16
INCRM	DC.W 0
X	EQU 16
Y	EQU 16
LETRAS	EQU 40
ROXFONT	MOVE.W #(X*Y*LETRAS)-1,D6
	LEA FONT1,A0
	MOVEQ #-1,D1
COMPL	MOVE.W (A0)+,D0
	BEQ.S NORML
	MOVE.W D1,-2(A0)
NORML	DBF D6,COMPL
	LEA FONT1,A0
	LEA FONT2,A1
	MOVE.W #(Y*LETRAS)-1,D6
ROXLE	ADDQ.L #1,A1
	REPT 30 
	MOVE.B (A0)+,(A1)+
	ENDR
	ADDQ.L #1,A1
	ADDQ.L #2,A0
	DBF D6,ROXLE
	RTS
STEXTBL	LEA TEXTB,A0
	LEA TEXTL,A1
TRASCII	MOVEQ #0,D0
	MOVE.B (A0)+,D0
	BPL.S BUSCALO
	MOVE.L #-1,(A1)+
	RTS
BUSCALO	BSR SEEK
	MULU #16*16*2,D0
	ADD.L #FONT1,D0
	MOVE.L D0,(A1)+
	BRA.S TRASCII
SEEK	MOVEQ #-1,D1
	LEA CHRSET,A2
FETCH	MOVE.B (A2)+,D2
	BMI.S NOFOUND
	ADDQ.W #1,D1
	CMP.B D0,D2
	BNE.S FETCH
NOFOUND	MOVE.W D1,D0
	RTS
CAWA	DC.L WAXL
SCREEN	DC.L $F8000
WAXL	DC.W 0,0,0,1,1,1,2,2,2,2,3,3,3,3,3,2,2,2,2,1,1,1,0,0,0
	DC.W 0,0,0,-1,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1,-1,0,0,0
	DC.W 55
CHRSET	DC.B 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890?., ',-1
CTEXT	DC.L TEXTL
TEXTB	DC.B '   HELLO LAMERS THIS IS MY NEW SCROLLER   ',-1
TEXTL	DS.L TEXTL-TEXTB
FONT1	INCBIN 'FONT1616.BIN'
FONT2	DS.B FONT2-FONT1