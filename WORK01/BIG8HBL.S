** RUTINA DE "BIG SCROLL" O POR LO MENOS
** AMPLIADO. SE PUEDE HACER MAS GRANDE 
** MUY FACILMENTE. LA FUENTE LA HACES
** CON EL CUTTER8.S. GRABANDO DESDE FONT
** HASTA A1-1 (COMO HAGO SIEMPRE)
** PON UNOS 5 ESPACIOS AL PRINCIPIO
** Y 6 O ASI AL FINAL.

** V 1.00 (FALTA QUE ADMITA ALGUNOS CARACTERES)

** (C) 1990 RED DEVIL  

LLE1	EQU $F8000+(60*160)
LLE2	EQU $F8000+(8*4)+(60*160)
LLE3	EQU $F8000+(8*4*2)+(60*160)
LLE4	EQU $F8000+(8*4*3)+(60*160)
LLE5	EQU $F8000+(8*4*4)+(60*160)
LLE6	EQU $F8000+(8*4*5)+(60*160)

PSTEP	MACRO numero	
	MOVE.W (A0)+,D0
	MOVE.W D0,8*\1(A1)
	MOVE.W D0,(160*1)+(8*\1)(A1)
	MOVE.W D0,(160*2)+(8*\1)(A1)
	MOVE.W D0,(160*3)+(8*\1)(A1)
	MOVE.W D0,(160*4)+(8*\1)(A1)
	MOVE.W D0,(160*5)+(8*\1)(A1)
	MOVE.W D0,(160*6)+(8*\1)(A1)
	MOVE.W D0,(160*7)+(8*\1)(A1)
	ENDM

ZOOMCH	EQU 8

	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	LEA $F8000,A0
	MOVE.W #(32000/8)-1,D0
LOOOOS	CLR.L (A0)+
	CLR.L (A0)+
	DBF D0,LOOOOS
	BSR GETFONT
	BSR ROTAX
	BSR SETTEXT
	BSR HBLON
LOOP	CLR.B SYNC
N_SYNC	TST.B SYNC
	BEQ.S N_SYNC
	CMP.B #$39,$FFFFFC02.W
	BNE.S LOOP
	BSR HBLOFF
	CLR.L -(A7)
	TRAP #1
SC_BIG	ADDQ.W #1,COFF
	CMP.W #1,COFF
	BEQ COKK1
	CMP.W #2,COFF
	BEQ COKK2
	CMP.W #3,COFF
	BEQ COKK3
	CMP.W #4,COFF
	BEQ COKK4
	CMP.W #5,COFF
	BEQ COKK5
	CMP.W #6,COFF
	BEQ COKK6
	CMP.W #7,COFF
	BEQ COKK7
COKK8	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL3
	MOVEA.L (A2)+,A0
	LEA LLE2-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-16-8,A1
	BSR PRINT33
	ADDQ.L #4,C_LEE
	MOVE.L C_LEE,A0
	MOVE.L 5*4(A0),D0
	BPL.S NOFIN
	MOVE.L #STEXT,C_LEE
NOFIN	CLR.W COFF
	RTS
COKK1	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5,A1
	BSR PRINTLE
	RTS
COKK2	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE2,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5,A1
	BSR PRINTLE
	RTS
COKK3	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL1
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-8,A1
	BSR PRINT11
	RTS
COKK4	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL1
	MOVEA.L (A2)+,A0
	LEA LLE2-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-8,A1
	BSR PRINT11
	RTS
COKK5	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-16,A1
	BSR PRINT22
	RTS
COKK6	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL2
	MOVEA.L (A2)+,A0
	LEA LLE2-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-16,A1
	BSR PRINT22
	RTS
COKK7	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL3
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-16-8,A1
	BSR PRINT33
	RTS
ROTAX	LEA FONT,A0
	LEA RFONT,A1
	MOVE.W #(8*80)-1,D0
COPIAL2	MOVE.B #0,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	ADDQ.L #1,A0
	DBF D0,COPIAL2
	RTS	
PRINTLE	MOVEQ #7-1,D1
PLE	PSTEP 0
	PSTEP 1
	PSTEP 2
	PSTEP 3
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE
	RTS
PRINTL1	MOVEQ #7-1,D1
PLE1	ADDQ.L #2,A0
	PSTEP 0
	PSTEP 1
	PSTEP 2
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE1
	RTS
PRINTL2	MOVEQ #7-1,D1
PLE2	ADDQ.L #2*2,A0
	PSTEP 0
	PSTEP 1
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE2
	RTS
PRINTL3	MOVEQ #7-1,D1
PLE3	ADDQ.L #2*3,A0
	PSTEP 0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE3
	RTS
PRINT11	MOVEQ #7-1,D1
PLE11	PSTEP 0
	ADDQ.W #3*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE11
	RTS
PRINT22	MOVEQ #7-1,D1
PLE22	PSTEP 0
	PSTEP 1
	ADDQ.W #2*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE22
	RTS
PRINT33	MOVEQ #7-1,D1
PLE33	PSTEP 0
	PSTEP 1
	PSTEP 2
	ADDQ.W #1*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE33
	RTS
SETTEXT	LEA TEXT,A0
	LEA STEXT,A1
LOOOPP	MOVEQ #0,D0
	MOVE.B (A0)+,D0
	BMI.S YAHHJ
	SUB.B #'A',D0
	MULU #2*4*8,D0
	ADD.L #FONT,D0
	MOVE.L D0,(A1)+
	BRA.S LOOOPP
YAHHJ	MOVE.L #-1,(A1)+
	RTS
GETFONT	LEA FONT,A0
	LEA RFONT,A2
QLLOO	MOVE.W (A0),D0
	CMP.W #0,D0
	BEQ.S CERO
	CMP.W #$0100,D0
	BEQ.S UNIZ
	CMP.W #$0001,D0
	BEQ.S UNDE
UNUN	MOVE.W #%1111111111111111,(A0)+
COMPAR	CMPA.L A0,A2
	BGT.S QLLOO
	RTS
CERO	MOVE.W #0,(A0)+
	BRA.S COMPAR
UNIZ	MOVE.W #%1111111100000000,(A0)+
	BRA.S COMPAR
UNDE	MOVE.W #%0000000011111111,(A0)+
	BRA.S COMPAR

LINES	EQU 1 ;STEP EN HBL

** INTERRUPCIONES

HBLON	** RETARDO PARA QUE APAREZCA
	** LA PANTALLA ANTES DE CERRAR
	** LAS INTERRUPCIONES (SE QUITA
	** CUANDO LO ENSAMBLE EN SERIO)

	MOVEQ #7,D0
L2	MOVEQ #-1,D1
L1	DBF D1,L1
	DBF D0,L2
	MOVE.W #$2700,SR
	MOVE.L $70.W,OLDVBL
	MOVE.B $FFFFFA09.W,OLDR9
	MOVE.B $FFFFFA0F.W,OLDRF
	MOVE.B $FFFFFA07.W,OLDR7
	MOVE.B $FFFFFA13.W,OLDR13
	MOVE.L $120.W,OLDHBL
	MOVE.L #N_VBL,$70.W
	MOVE.L #N_HBL,$120.W
	CLR.B $FFFFFA09.W
	CLR.B $FFFFFA07.W
	OR.B #1,$FFFFFA07.W
	OR.B #1,$FFFFFA13.W
	MOVE.W #$2300,SR
	RTS
HBLOFF	CLR.B SYNC
SYNK	TST.B SYNC
	BEQ SYNK
	MOVE.W #$2700,SR
	MOVE.L OLDVBL,$70.W
	MOVE.B OLDR9,$FFFFFA09.W
	MOVE.B OLDRF,$FFFFFA0F.W
	MOVE.B OLDR7,$FFFFFA07.W
	MOVE.B OLDR13,$FFFFFA13.W
	MOVE.L OLDHBL,$120.W
	MOVE.W #$2300,SR
	RTS
N_VBL	ST SYNC
	MOVEM.L D0-D7/A0-A6,-(A7)
	MOVE.W #$700,$FFFF8240.W
	BSR SC_BIG
	MOVE.W #$0,$FFFF8240.W
	MOVE.L #COLOR_B-2,COLOR_N
	MOVE.L #PR_HBL,$120.W
	CLR.B $FFFFFA1B.W
	MOVE.B #60,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVEM.L (A7)+,D0-D7/A0-A6
	RTE
PR_HBL	MOVE.L #N_HBL,$120.W
	CLR.B $FFFFFA1B.W
	MOVE.B #LINES,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	RTE
N_HBL	MOVE.L A0,-(A7)
	ADDQ.L #2,COLOR_N
	MOVEA.L COLOR_N,A0
	MOVE.W (A0),$FFFF8242.W
	MOVE.L (A7)+,A0
	CMP.L #COLOR_B+(2*64),COLOR_N
	BNE.S NO_END
	CLR.B $FFFFFA1B.W
NO_END	BCLR #0,$FFFFFA0F.W
	RTE

** DATOS

SYNC	DS.W 1
OLDR7	DS.B 1
OLDR9	DS.B 1
OLDRF	DS.B 1
OLDR13	DS.B 1
COLOR_N	DS.L 1
OLDVBL	DS.L 1
OLDHBL	DS.L 1

** ESTO LO TENGO QUE RETOCAR...

COLOR_B	REPT 20
	DC.W 0,2,4,6
	DC.W $106,$205,$304,$403,$502,$601,$700
	DC.W $710,$720,$730,$740,$750,$760,$770
	DC.W $771,$772,$773,$774,$775,$776,$777
	DC.W $777,$777,$777,$777
	DC.W $777,$777,$777,$777
	DC.W $777,$776,$775,$774,$773,$772,$771
	DC.W $770,$760,$750,$740,$730,$720,$710
	DC.W $700,$601,$502,$403,$304,$205,$106
	DC.W 6,4,2,0
	ENDR
C_LEE	DC.L STEXT
COFF	DS.W 1
TEXT	DC.B '     HOLA CHICOS ESTO ES MI NUEVO SCROLLER QUE POR CIERTO ES RAPIDO EN VBL  EL TIEMPO QUE OCUPA ESTA ARRIBA EN ROJO ADIOS     ',-1
STEXT	DS.L (STEXT-TEXT)	
FONT	INCBIN 'FONTB8P.RED'
RFONT



