	PEA 0
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	BSR CLS
	LEA NUMF,A6
	BSR MAKEN
	LEA $F8000,A1
	LEA NUMF,A0
	MOVE.L #$F121,D0	
	BSR S_NUM
	CLR.L -(A7)
	TRAP #1
S_NUM	MOVE.W D0,D1
	LSR.W #8,D0
	AND.W #$FF,D1
	LSL.W #4,D0
	LSL.W #4,D1
	LEA 0(A0,D0.W),A2
	MOVE.W (A2)+,(A1)
	MOVE.W (A2)+,(160*1)(A1)
	MOVE.W (A2)+,(160*2)(A1)
	MOVE.W (A2)+,(160*3)(A1)
	MOVE.W (A2)+,(160*4)(A1)
	MOVE.W (A2)+,(160*5)(A1)
	MOVE.W (A2)+,(160*6)(A1)
	MOVE.W (A2),(160*7)(A1)
	ADDQ.L #8,A1
	LEA 0(A0,D1.W),A2
	MOVE.W (A2)+,(A1)
	MOVE.W (A2)+,160*1(A1)
	MOVE.W (A2)+,160*2(A1)
	MOVE.W (A2)+,160*3(A1)
	MOVE.W (A2)+,160*4(A1)
	MOVE.W (A2)+,160*5(A1)
	MOVE.W (A2)+,160*6(A1)
	MOVE.W (A2),160*7(A1)
	RTS
CLS	LEA $F8000,A0
	MOVE.W #(32000/8)-1,D0
CDFF	CLR.L (A0)+
	CLR.L (A0)+
	DBF D0,CDFF
	RTS
PULE	MOVE.B (A3)+,D0	
	BMI.S SALTD
	LEA CHAR,A2
	MOVEQ #-1,D7
SFOC	MOVE.B (A2)+,D6
	BMI.S SALDE
	ADDQ.W #1,D7
	CMP.B D6,D0
	BNE.S SFOC
SALDE	MOVEQ #0,D0
	MOVE.B D7,D0
	LSL.W #3,D0 
	ADD.L #FKK,D0
	MOVEA.L D0,A0
	EOR.B #-1,CDK
	BEQ.S SECV
	ADDQ.L #6,A1
SECV	ADDQ.L #1,A1
	MOVE.B (A0)+,(A1)
	MOVE.B (A0)+,160*1(A1)
	MOVE.B (A0)+,160*2(A1)
	MOVE.B (A0)+,160*3(A1)
	MOVE.B (A0)+,160*4(A1)
	MOVE.B (A0)+,160*5(A1)
	MOVE.B (A0)+,160*6(A1)
	MOVE.B (A0)+,160*7(A1)
	BRA.S PULE		
SALTD	CLR.W CDK
	RTS
MAKEN	MOVE.W #-1,D2
OTRON	ADDQ.W #1,D2
	CMP.W #256,D2
	BEQ.S ENDNU
	MOVEQ #0,D3
	MOVEQ #0,D4
	MOVE.B D2,D3
	MOVE.B D2,D4
	LSR.W #4,D4
	AND.B #%00001111,D3
	LEA NUMEROS,A5
	LEA 0(A5,D3.W),A4
	MOVE.B (A4),COMPO+1
	LEA 0(A5,D4.W),A4
	MOVE.B (A4),COMPO
	LEA COMPO,A3
	LEA $F8000-7,A1
	MOVE.L D2,-(A7)
	BSR PULE
	BSR SAVEN
	MOVE.L (A7)+,D2
	BRA.S OTRON 
ENDNU	RTS
SAVEN	LEA $F8000,A0
	MOVE.W (A0),(A6)+
	MOVE.W 160*1(A0),(A6)+
	MOVE.W 160*2(A0),(A6)+
	MOVE.W 160*3(A0),(A6)+
	MOVE.W 160*4(A0),(A6)+
	MOVE.W 160*5(A0),(A6)+
	MOVE.W 160*6(A0),(A6)+
	MOVE.W 160*7(A0),(A6)+
	RTS
COMPO	DC.B '  ',-1
NUMEROS	DC.B '0123456789ABCDEF'
CDK	DS.W 1
CHAR	DC.B "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789:!. \_+-=?(),'",'"',-1
NUMF	DS.W 255*8	
FKK	INCBIN 'FONT8P2.RED'
	