** RUTINA DE "BIG SCROLL" O POR LO MENOS
** AMPLIADO. SE PUEDE HACER MAS GRANDE 
** MUY FACILMENTE. LA FUENTE LA HACES
** CON EL CUTTER8.S. GRABANDO DESDE FONT
** HASTA A1-1 (COMO HAGO SIEMPRE)
** PON UNOS 5 ESPACIOS AL PRINCIPIO
** Y 6 O ASI AL FINAL.

** V 1.00 (FALTA QUE ADMITA ALGUNOS CARACTERES)

** (C) 1990 RED DEVIL  

LLE1	EQU $F8000
LLE2	EQU $F8000+(8*4)
LLE3	EQU $F8000+(8*4*2)
LLE4	EQU $F8000+(8*4*3)
LLE5	EQU $F8000+(8*4*4)
LLE6	EQU $F8000+(8*4*5)

PSTEP	MACRO numero	
	MOVE.W (A0)+,D0
	MOVE.W D0,8*\1(A1)
	MOVE.W D0,(160*1)+(8*\1)(A1)
	MOVE.W D0,(160*2)+(8*\1)(A1)
	MOVE.W D0,(160*3)+(8*\1)(A1)
	MOVE.W D0,(160*4)+(8*\1)(A1)
	MOVE.W D0,(160*5)+(8*\1)(A1)
	MOVE.W D0,(160*6)+(8*\1)(A1)
	MOVE.W D0,(160*7)+(8*\1)(A1)
	ENDM

ZOOMCH	EQU 8

	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	LEA $F8000,A0
	MOVE.W #(32000/8)-1,D0
LOOOOS	CLR.L (A0)+
	CLR.L (A0)+
	DBF D0,LOOOOS
	BSR GETFONT
	BSR ROTAX
	BSR SETTEXT
MEM	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	MOVE.W #$700,$FFFF8240.W
	BSR SC_BIG
	MOVE.W #$777,$FFFF8240.W
	BRA.S MEM
SC_BIG	ADDQ.W #1,COFF
	CMP.W #1,COFF
	BEQ COKK1
	CMP.W #2,COFF
	BEQ COKK2
	CMP.W #3,COFF
	BEQ COKK3
	CMP.W #4,COFF
	BEQ COKK4
	CMP.W #5,COFF
	BEQ COKK5
	CMP.W #6,COFF
	BEQ COKK6
	CMP.W #7,COFF
	BEQ COKK7
COKK8	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL3
	MOVEA.L (A2)+,A0
	LEA LLE2-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-16-8,A1
	BSR PRINT33
	ADDQ.L #4,C_LEE
	MOVE.L C_LEE,A0
	MOVE.L 5*4(A0),D0
	BPL.S NOFIN
	MOVE.L #STEXT,C_LEE
NOFIN	CLR.W COFF
	RTS
COKK1	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5,A1
	BSR PRINTLE
	RTS
COKK2	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE2,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5,A1
	BSR PRINTLE
	RTS
COKK3	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL1
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-8,A1
	BSR PRINT11
	RTS
COKK4	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL1
	MOVEA.L (A2)+,A0
	LEA LLE2-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-8,A1
	BSR PRINT11
	RTS
COKK5	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-16,A1
	BSR PRINT22
	RTS
COKK6	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	LEA LLE1,A1
	BSR PRINTL2
	MOVEA.L (A2)+,A0
	LEA LLE2-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE3-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE4-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE5-16,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	LEA LLE6-16,A1
	BSR PRINT22
	RTS
COKK7	MOVEA.L C_LEE,A2
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE1,A1
	BSR PRINTL3
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE2-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE3-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE4-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE5-16-8,A1
	BSR PRINTLE
	MOVEA.L (A2)+,A0
	ADD.L #4*2*8*80,A0
	LEA LLE6-16-8,A1
	BSR PRINT33
	RTS
ROTAX	LEA FONT,A0
	LEA RFONT,A1
	MOVE.W #(8*80)-1,D0
COPIAL2	MOVE.B #0,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	MOVE.B (A0)+,(A1)+
	ADDQ.L #1,A0
	DBF D0,COPIAL2
	RTS	
PRINTLE	MOVEQ #7-1,D1
PLE	PSTEP 0
	PSTEP 1
	PSTEP 2
	PSTEP 3
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE
	RTS
PRINTL1	MOVEQ #7-1,D1
PLE1	ADDQ.L #2,A0
	PSTEP 0
	PSTEP 1
	PSTEP 2
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE1
	RTS
PRINTL2	MOVEQ #7-1,D1
PLE2	ADDQ.L #2*2,A0
	PSTEP 0
	PSTEP 1
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE2
	RTS
PRINTL3	MOVEQ #7-1,D1
PLE3	ADDQ.L #2*3,A0
	PSTEP 0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE3
	RTS
PRINT11	MOVEQ #7-1,D1
PLE11	PSTEP 0
	ADDQ.W #3*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE11
	RTS
PRINT22	MOVEQ #7-1,D1
PLE22	PSTEP 0
	PSTEP 1
	ADDQ.W #2*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE22
	RTS
PRINT33	MOVEQ #7-1,D1
PLE33	PSTEP 0
	PSTEP 1
	PSTEP 2
	ADDQ.W #1*2,A0
	LEA 160*ZOOMCH(A1),A1
	DBF D1,PLE33
	RTS
SETTEXT	LEA TEXT,A0
	LEA STEXT,A1
LOOOPP	MOVEQ #0,D0
	MOVE.B (A0)+,D0
	BMI.S YAHHJ
	SUB.B #'A',D0
	MULU #2*4*8,D0
	ADD.L #FONT,D0
	MOVE.L D0,(A1)+
	BRA.S LOOOPP
YAHHJ	MOVE.L #-1,(A1)+
	RTS
GETFONT	LEA FONT,A0
	LEA RFONT,A2
QLLOO	MOVE.W (A0),D0
	CMP.W #0,D0
	BEQ.S CERO
	CMP.W #$0100,D0
	BEQ.S UNIZ
	CMP.W #$0001,D0
	BEQ.S UNDE
UNUN	MOVE.W #%1111111111111111,(A0)+
COMPAR	CMPA.L A0,A2
	BGT.S QLLOO
	RTS
CERO	MOVE.W #0,(A0)+
	BRA.S COMPAR
UNIZ	MOVE.W #%1111111100000000,(A0)+
	BRA.S COMPAR
UNDE	MOVE.W #%0000000011111111,(A0)+
	BRA.S COMPAR

C_LEE	DC.L STEXT
COFF	DS.W 1
TEXT	DC.B '     HOLA CHICOS ESTO ES MI NUEVO SCROLLER QUE POR CIERTO ES RAPIDO EN VBL  EL TIEMPO QUE OCUPA ESTA ARRIBA EN ROJO ADIOS     ',-1
STEXT	DS.L (STEXT-TEXT)	
FONT	INCBIN 'FONTB8P.RED'
RFONT

