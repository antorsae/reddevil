** BIEN, BASICAMENTE ESTA ES LA
** RUTINA DE ROTACION CON DOS 
** ANGULOS (REFERENTE AL EJE X
** Y AL EJE Y). NO LLEGAN A SER
** 3D REALES (POR EL PUNTO DE FUGA)
** PERO EL EFECTO BUENO, Y ADEMAS
** PARECE SER QUE ES RAPIDA....

** MEREZCO UNOS APLAUSOS PUES HE
** TENIDO QUE REALIZAR TODO EL TEMA
** MATEMATICO CON DEDUCCIONES PROPIAS
** LO CUAL NO ES FACIL CONSIDERANDO
** MI TEMPRANA EDAD (DENTRO DE UNA
** SEMANA CUMPLO 16 A¥OS)
 
** (C) 1990 RED DEVIL

LON	EQU $800*2
BASE	EQU $F8000
NBAL	EQU 51
	PEA 0
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA $2000,A7
	BSR PREPAL
ME	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	LEA BASE+(5*8)+(30*160),A0
	MOVE.W #140-1,D0
	MOVEQ #0,D1
CLSLLOP	MOVE.W D1,(A0)
	MOVE.W D1,8*1(A0)
	MOVE.W D1,8*2(A0)
	MOVE.W D1,8*3(A0)
	MOVE.W D1,8*4(A0)
	MOVE.W D1,8*5(A0)
	MOVE.W D1,8*6(A0)
	MOVE.W D1,8*7(A0)
	MOVE.W D1,8*8(A0)
	MOVE.W D1,8*9(A0)
	LEA 160(A0),A0
	DBF D0,CLSLLOP
	BSR ROTAL
	BRA.S ME
ROTAL	LEA CORDS(PC),A0
	LEA BASE,A1
	LEA TRIGO(PC),A2
	LEA LON(A2),A3
	LEA PROT(PC),A4
	MOVEQ #NBAL-1,D7
GEN3D	BSR GEN
	ADDQ.L #6,A0
	DBF D7,GEN3D
	RTS
GEN	MOVEQ #16,D0
	ADD.W D0,2(A0)
	AND.W #LON-1,2(A0)
	MOVEQ #10,D0
	ADD.W D0,4(A0)
	AND.W #LON-1,4(A0)
	MOVEQ #0,D0
	MOVE.W (A0),D0
	MOVE.W D0,D1
	MOVE.W 2(A0),D2
	MOVE.W 4(A0),D3
	
	MULU 0(A2,D2.W),D0
	MULU 0(A3,D3.W),D1
	
	ADD.L D0,D0
	ADD.L D1,D1
	CLR.W D0
	CLR.W D1
	SWAP D0
	SWAP D1
	
	
	
	*LSR.L #8,D0
	*LSR.L #8,D1
	*LSR.L #7,D0
	*LSR.L #7,D1
	
	MOVEQ #0,D3
	SUB.W (A0),D0
	SUB.W (A0),D1
	ADD.W #320/2,D0
	ADD.W #200/2,D1
	
	MULU #160,D1
	MOVE.W D0,D2
	AND.W #16-1,D2
	AND.W #$10000-15,D0
	LSR.W #1,D0
	ADD.W D2,D2
	ADD.W D1,D0
	
	MOVE.W 0(A4,D2.W),0(A1,D0.W)
	RTS
	
	
	
PREPAL	LEA PROT(PC),A0
	MOVEQ #16-1,D0
DOCVT	MOVEQ #0,D1
	BSET D0,D1
	MOVE.W D1,(A0)+
	DBF D0,DOCVT
	LEA TRIGO(PC),A0
	MOVE.W #(LON*2*2)-1,D0
	MOVE.W #$8000,D1
DOADD	ADD.W D1,(A0)+
	DBF D0,DOADD
	LEA LOG2D(PC),A0
	LEA CORDS(PC),A1
	MOVEQ #NBAL-1,D0
TRANS	MOVE.W (A0)+,(A1)+
	MOVE.W (A0)+,D1
	ADD.W D1,D1
	MOVE.W D1,(A1)+
	MOVE.W D1,(A1)+
	DBF D0,TRANS
	RTS
PROT	DS.W 16
LOG2D	INCBIN 'LOGO.POL'
CORDS	DS.W 3*NBAL
TRIGO	INCBIN 'SIN_COS.RED'
	