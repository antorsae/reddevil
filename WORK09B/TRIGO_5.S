** HOLA! OTRA VEZ ALGO INNOVADOR POR 
** ESTAS TIERRAS: RUTINA DE ROTACION
** DE PUNTOS EN ANGULO EJE_X Y EJE_Y
** REALMENTE NO SON 3D REALES  ( POR 
** AUSENCIA DE EJE_Z) PERO EL EFECTO
** ES BUENO... 

** MEREZCO UNOS APLAUSOS PUES HE
** TENIDO QUE REALIZAR TODO EL TEMA
** MATEMATICO CON DEDUCCIONES PROPIAS
** LO CUAL NO ES FACIL CONSIDERANDO
** MI TEMPRANA EDAD (DENTRO DE UNA
** SEMANA CUMPLO 16 A¥OS)
 
** (C) 1990 RED DEVIL

LON	EQU $800*2
BASE	EQU $F0000
	PEA 0
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA $2000,A7
	MOVEQ #1,D0
	BSR SLCORD
	BSR PREPAL
	BSR CLS
ME	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	
	BSR CHGSC
	BSR CLR
	BSR ROTAL
	BSR PLINES
	BRA.S ME
SCREEN	DC.L BASE
CHGSC	LEA SCREEN(PC),A0
	MOVE.L (A0),D0
	BCHG #15,D0
	MOVE.L D0,(A0)
	LSR.L #8,D0
	MOVE.B D0,$FFFF8203.W
	LSR.W #8,D0
	MOVE.B D0,$FFFF8201.W
	RTS
CLR	MOVEA.L SCREEN,A0
	LEA (5*8)+(30*160)(A0),A0
	MOVE.W #140-1,D0
	MOVEQ #0,D1
CLSLLOP	MOVE.W D1,(A0)
	MOVE.W D1,8*1(A0)
	MOVE.W D1,8*2(A0)
	MOVE.W D1,8*3(A0)
	MOVE.W D1,8*4(A0)
	MOVE.W D1,8*5(A0)
	MOVE.W D1,8*6(A0)
	MOVE.W D1,8*7(A0)
	MOVE.W D1,8*8(A0)
	MOVE.W D1,8*9(A0)
	LEA 160(A0),A0
	DBF D0,CLSLLOP
	RTS
ROTAL	LEA LOG2D(PC),A0
	LEA RLOGO(PC),A1
	LEA TRIGO(PC),A2
	LEA LON(A2),A3
	LEA PROT(PC),A4
	MOVE.W #LON-1,D5
	
GEN3D	BSR GEN
	MOVE.L (A0),D0
	SWAP D0
	TST.W D0
	BPL.S GEN3D
	ADDQ.L #2,A0
	MOVE.W D0,(A1)+
	SWAP D0
	TST.W D0
	BPL.S GEN3D
GONOW	MOVE.W D0,(A1)
	RTS
GEN	MOVE.W (A0)+,D4
	MOVE.W D4,D0
	ADD.W D0,D0
	MOVE.W D0,D1	
	
	MOVE.W (A0),D2
	ADD.W #$20,D2
	AND.W D5,D2
	MOVE.W D2,(A0)+
	MOVE.W (A0),D3
	ADD.W #$18,D3
	AND.W D5,D3
	MOVE.W D3,(A0)+
	
	MULU 0(A2,D2.W),D0
	MULU 0(A3,D3.W),D1
	
	SWAP D0
	SWAP D1
	
	SUB.W D4,D0
	SUB.W D4,D1
	ADD.W #320/2,D0
	ADD.W #200/2,D1
	MOVE.W D0,(A1)+
	MOVE.W D1,(A1)+
	RTS
PLINES	LEA RLOGO(PC),A1
	MOVE.W (A1)+,D0
	MOVE.W (A1)+,D1
	
MORE	MOVE.W (A1),D2
	MOVE.W 2(A1),D3
	MOVEA.L SCREEN,A0
	*MOVEQ #0,D0
	*MOVEQ #0,D1
	*MOVE.W #200,D2
	*MOVEQ #100,D3
	
	BSR LINE
	
	MOVE.W (A1)+,D0
	MOVE.W (A1)+,D1
	MOVE.W (A1),D7
	BPL.S MORE
	ADDQ.L #2,A1
	MOVE.W (A1)+,D0
	BMI.S GOGOGO
	MOVE.W (A1)+,D1
	BRA.S MORE
GOGOGO	RTS
LINE	MOVEQ #1,D6
	MOVE.W #160,D7
	
	MOVE.W D2,D4
	MOVE.W D3,D5
	SUB.W D0,D4
	BPL.S D4POS
	NEG.W D4
	MOVEQ #-1,D6
D4POS	SUB.W D1,D5
	BPL.S D5POS
	NEG.W D5
	MOVE.W #-160,D7
D5POS	CMP.W D4,D5
	BLT.S GOLIX
	TST.W D7
	BPL.S NOCHG1
	EXG D0,D2
	EXG D1,D3
	NEG.W D6
NOCHG1	*SUB.W D1,D3
	SUBQ.W #1,D5
	ADD.W D1,D1
	ADD.W LCORD(PC,D1.W),A0
	RTS	
GOLIX	TST.W D6
	BPL.S NOCHG2
	EXG D0,D2
	EXG D1,D3
	NEG.W D7
NOCHG2	SUBQ.W #1,D4
	MOVE.W D4,D3
	DIVU D4,D5
	SWAP D5
	ADD.W D1,D1
	ADD.W LCORD(PC,D1.W),A0
	MOVE.W D0,D1
	LSR.W #1,D0
	AND.W #%1111111111111000,D0
	ADD.W D0,A0
	AND.W #%1111,D1
	ADD.W D1,D1
	MOVEQ #0,D2
LREDDAL	ADDQ.W #2,D1
	AND.W #32-1,D1
	BNE.S NADD
	ADDQ.L #8,A0
NADD	MOVE.W (A0),D0
	OR.W PROT(PC,D1.W),D0
	MOVE.W D0,(A0)
	ADD.W D5,D2
	CMP.W D2,D3
	BGT.S NOSUM
	SUB.W D3,D2
	ADDA.W D7,A0
NOSUM	DBF D4,LREDDAL
	RTS
		
PROT	DS.W 16
LCORD	DS.W 200
SLCORD	LEA LCORD(PC),A0
	MOVE.W #200-1,D0
	MOVEQ #0,D1
DOLMUL	MOVE.W D1,(A0)+
	ADD.W #160,D1
	DBF D0,DOLMUL
	RTS
CLS	LEA BASE,A0
	LEA BASE+$8000+$7D00,A1
CDF	CLR.L (A0)+
	CMPA.L A0,A1
	BGT.S CDF
	RTS
PREPAL	LEA PROT(PC),A0
	MOVEQ #16-1,D0
DOCVT	MOVEQ #0,D1
	BSET D0,D1
	MOVE.W D1,(A0)+
	DBF D0,DOCVT
	LEA TRIGO(PC),A0
	MOVE.W #(LON*2*2)-1,D0
	MOVE.W #$8000,D1
DOADD	ADD.W D1,(A0)+
	DBF D0,DOADD
	LEA LOG2D(PC),A0
TRANS	ADDQ.L #2,A0
	MOVE.W (A0),D1
	ADD.W D1,D1
	MOVE.W D1,(A0)+
	MOVE.W (A0),D1
	ADD.W D1,D1
	MOVE.W D1,(A0)+
	MOVE.W (A0),D0
	BPL.S TRANS
	ADDQ.L #2,A0
	MOVE.W (A0),D0
	BPL.S TRANS
	MOVE.L #-1,-8(A0)
	RTS
LOG2D	INCBIN 'LOGO.LIN'
	DC.L -1
TRIGO	INCBIN 'SIN_COS.RED'
RLOGO