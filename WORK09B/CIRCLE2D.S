** RUTINA DE CONVERSION DE UN BLOQUE
** A SU IMAGEN DENTRO DE UNA BOLA, 
** LO CIERTO ES QUE EN ESTA VERSION
** AUN FALTA EL ENLARGAMIENTO
** VERTICAL,ASI COMO LA DISTORSION EN
** 3D.

** (C) 1990 RED DEVIL V.-1.00

VBASE	EQU $F8000-$7D00
X1	EQU 200
Y1	EQU 200
X2	EQU 64
Y2	EQU 64
	PEA 0
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA $2000,A7
	BSR CLS
	*BSR PLOGO
   	LEA PIC+34(PC),A0
	LEA VBASE,A1
	BSR DEPACK
	BSR CIRCLE
	PEA 0
	TRAP #1
CLS	LEA VBASE+$7D00,A0
	LEA VBASE+($7D00*2),A1
CLSLOP	CLR.L (A0)+
	CMPA.L A0,A1
	BGT.S CLSLOP
	RTS
CIRCLE	BSR XSCAL
XSCAL	LEA VBASE,A0
	LEA SINUS(PC),A2
	MOVEQ #Y2-1,D7
LIN_Y	MOVE.W #X1,D0
	MOVE.W (A2)+,D1
	BSR XLINE
	LEA 160(A0),A0
	DBF D7,LIN_Y
	RTS
XLINE	ADDQ.W #1,D1
	MOVE.W D1,D2
	DIVU D1,D0
	MOVE.W D0,D3
	SWAP D0
	SUBQ.W #2,D1
	BMI.S FUERAX 	
	MOVE.W D1,D5
	ADDQ.W #1,D5
	LSR.W #1,D5
	MOVE.W #X1/2,D4
	SUB.W D5,D4
	MOVEQ #0,D5
	MOVEQ #0,D6
XESC	ADD.W D0,D6
	CMP.W D6,D2
	BGT.S NOSUMX
	ADDQ.W #1,D5
	SUB.W D2,D6
NOSUMX	ADD.W D3,D5
	BSR PLOT
	ADDQ.W #1,D4
	DBF D1,XESC
FUERAX	RTS
PLOT	MOVEM.W D0-D3/D7,-(A7)
	MOVEQ #0,D0
	MOVEQ #0,D3
	MOVE.W D4,D3
	DIVU #16,D3
	LSL.W #3,D3
	LEA 0(A0,D3.W),A1
	LEA 160*Y1(A1),A1
	SWAP D3
	MOVEQ #16-1,D1
	SUB.W D3,D1
	BSET D1,D0
	MOVEQ #0,D3
	MOVE.W D5,D3
	DIVU #16,D3
	LSL.W #3,D3
	MOVEQ #0,D1
	SWAP D3
	MOVEQ #16-1,D2
	SUB.W D3,D2
	BSET D2,D1
	SWAP D3
	MOVE.W D0,D2
	NOT.W D2
	MOVE.W 0(A0,D3.W),D7
	AND.W D1,D7
	BEQ.S NOPUT1
	AND.W D2,(A1)
	OR.W D0,(A1)
NOPUT1	MOVE.W 2(A0,D3.W),D7
	AND.W D1,D7
	BEQ.S NOPUT2
	AND.W D2,2(A1)
	OR.W D0,2(A1)
NOPUT2	MOVE.W 4(A0,D3.W),D7
	AND.W D1,D7
	BEQ.S NOPUT3
	AND.W D2,4(A1)
	OR.W D0,4(A1)
NOPUT3	MOVE.W 6(A0,D3.W),D7
	AND.W D1,D7
	BEQ.S NOPUT4
	AND.W D2,6(A1)
	OR.W D0,6(A1)
NOPUT4	MOVEM.W (A7)+,D0-D3/D7
	RTS	
DEPACK	MOVE.L #2,D0
	NEG.B D0
	MOVE.W	#$C7,D4		; 200 LINEAS
	CLR.W	D7
	CLR.B	D0
L30842	MOVE.L	A1,-(A7) 	; A1=DI PANTALLA
	MOVE.W	#3,D5
L30848	MOVE.L	A1,-(A7)
	MOVE.W	#$13,D6
L3084E	BSR.S	L3086E
	BSR.S	L3086E
	LEA	6(A1),A1
	DBF	D6,L3084E
	MOVEA.L	(A7)+,A1
	ADDQ.L	#2,A1
	DBF	D5,L30848
	MOVEA.L	(A7)+,A1
	LEA	$A0(A1),A1
	DBF	D4,L30842
	RTS
L3086E	SUBQ.B	#1,D0
	BPL	L30892
L30874	MOVE.B	(A0)+,D0
	CMPI.B	#$80,D0
	BEQ	L30874
	BTST	#7,D0
	BNE	L3088C
	CLR.W	D7
	BRA	L30892
L3088C	NEG.B	D0
	MOVE.W	#$FFFF,D7
L30892	TST.W	D7
	BNE	L3089C
	MOVE.B	(A0)+,(A1)+
	RTS
L3089C	MOVE.B	(A0),(A1)+
	TST.B	D0
	BNE.S NOSUM
	ADDQ.L	#1,A0
NOSUM	RTS
PIC	INCBIN 'AUG.PC1'
SINUS	INCBIN 'CIRCLE.DIS'