 MOVE.L A7,MYSP 
 MOVE.L A7,A5
 MOVE.L #$77FFE,A7
 MOVE.L 4(A5),A5
 MOVE.L $C(A5),D0
 ADD.L $14(A5),D0
 ADD.L $1C(A5),D0
 ADD.L #$100,D0
 MOVE.L D0,-(SP)
 MOVE.L A5,-(SP)
 MOVE.L A5,AREA
 CLR.W -(SP)
 MOVE.W #$4A,-(SP)
 TRAP #1
 ADD.L #12,SP
 CLR.L -(SP)
 MOVE.W #$20,-(SP)
 TRAP #1
 ADDQ.L #6,SP
 MOVE.L D0,SR_USER
 CLR.W -(SP)
 pea -1
 PEA -1
 MOVE.W #5,-(SP)
 TRAP #14
 ADD.L #12,SP
 LEA $FF8240,A5
 LEA PAL,A6
 MOVE.W #32,D0
 BSR MOV
 LEA $FF8240,A0
 MOVE.W #16,D0
 CLR.B $484
BUL
 CLR (A0)+
 DBF D0,BUL
 BSR MUSIC1
 LEA PIC+34,A5
 MOVE.L $44E,A6
 MOVE.W #32000,D0
 BSR MOV
 PEA PIC+2
 MOVE.W #6,-(SP)
 TRAP #14
 ADDQ.L #6,SP
restart	
        lea	message2,a6 
nextlet	move.b 	(a6)+,d0
	cmp.b 	#$ff,d0
	bne.s 	notend
	bra.s 	restart
notend	clr.w 	d5
	andi.l 	#$ff,d0
	lea 	FONT,a1
	adda.l 	d0,a1
	lea 	build,a2
	moveq.l	#7,d7
allchar	move.b 	(a1),(a2)+
	adda.l 	#$100,a1
	dbf 	d7,allchar
test0	cmpi.b 	#0,zero2
	bne.s 	sub1
	move.w 	#37,-(a7)
	trap 	#14
	addq.l	#2,a7
	move.b 	#2,zero2
sub1	subq.b 	#1,zero2
key	move.l 	#$600ff,-(a7)
	trap 	#1
	addq.l 	#4,a7
	tst.w 	d0
	bne.s 	keyhit
 	SWAP D0
	CMP.W #$3B,D0
	BEQ CM1
	CMP.W #$3C,D0
	BEQ CM2
	CMP.W #$3D,D0
	BEQ CM3
cont	moveq.l #0,d0
	lea 	build,a5
	move.l $44e,A0
	ADDA.L #$7580,A0
	moveq.l #7,d7
lines	move.l 	a0,-(a7)
	adda.l 	#$138,a0
	move.b 	(a5),d1
	lsl.b 	#1,d1
	move.b 	d1,(a5)+
	moveq.l #$13,d6
cols	move.w 	(a0),d1
	roxl.w 	#1,d1
	move.w 	d1,(a0)
	move.w 	d1,$2(a0)
	move.w 	d1,$4(a0)
	move.w 	d1,$6(a0)
	subq.l 	#8,a0
	dbf 	d6,cols
	movea.l (a7)+,a0
	adda.l 	#$a0,a0
	dbf 	d7,lines
	addq.w 	#1,d5
	andi.w 	#7,d5
	bne 	test0
	bra 	nextlet
keyhit;si se presiona..
 CMP.W #$20,D0
 BEQ ROM
 CMP.W #$3B,D0
 BEQ CM1
 CMP.W #$3C,D0
 BEQ CM2
 CMP.W #$3D,D0
 BEQ CM3
 CMP.W #$30,D0
 BEQ NO0
 BRA cont
MOV
 MOVE.B (A5)+,(A6)+
 DBF D0,MOV
 RTS
CM1
 BSR MUSIC1
 BRA cont
CM2
 BSR MUSIC2
 BRA cont
CM3
 BSR MUSIC3
 BRA cont
NO0
 eor.b #2,$FF820A
 bra  cont
 RTS
ROM
 BSR ENDM
 LEA $FEE88E,A0
 LEA $500,A1
 MOVE.W	#$31,D0
L3FC74
 MOVE.W	(A0)+,(A1)+
 DBF	D0,L3FC74
 MOVE.L	#$500,$2C
 PEA SR_USER
 MOVE.W #$20,-(A7)
 TRAP #1
 ADDA.L #6,A7
 MOVEA.L MYSP,A7
 CLR.L -(A7)
 TRAP #1
ENDM
 PEA AREA
 MOVE.W #$49,-(A7)
 TRAP #1
 ADDA.L #6,A7
 LEA PAL,A5
 LEA $FF8240,A6
 MOVE.W #32,D0
 BSR MOV
 BSR CLS
 CLR.L $4E2.W
 CLR.L $4DA.W
 CLR.L $4D6.W
 MOVE.L	#$FF8800,A0
 MOVE.L	#$8080000,(A0)
 MOVE.L	#$9090000,(A0)
 MOVE.L	#$A0A0000,(A0)
 MOVE.W #0,-(A7)
 PEA -1
 PEA -1
 MOVE.W #5,-(A7)
 TRAP #14
 ADDA.L  #12,A7
 RTS	         
PICTURE	MOVE.W	#$7D00,D3
L3F984	MOVE.W	#1,D1
	MOVE.W	D3,D2
	LEA	0(A0,D3.W),A3
	LEA	0(A1,D3.W),A4
L3F992	MOVE.W	D1,D5
L3F994	MOVE.W	#$27,D4
L3F998	MOVE.L	-(A3),-(A4)
	DBF	D4,L3F998
	CMPA.L	A4,A1
	BEQ.S	L3F9B2
	SUBQ.W	#1,D5
	BEQ.S	L3F9AE
	ADDA.L	#$A0,A3
	BRA.S	L3F994
L3F9AE	ADDQ.W	#1,D1
	BRA.S	L3F992
L3F9B2	SUB.W	#$A0,D3
	BNE.S	L3F984
	RTS
CLS
 MOVEA.L $44E,A0
 MOVE.W #$7D00,D0
CLBU
 CLR.B (A0)+
 DBF D0,CLBU
 RTS
MUSIC1
 BSR FIMU
 LEA MUSI1,A0
 LEA $33C2C,A1
 MOVE.W #$2254,D0
CQ
 MOVE.B (A0)+,(A1)+
 DBF D0,CQ
 JSR $33C2C
 RTS
MUSIC2
 BSR FIMU
 LEA MUSI2,A0
 LEA $72000,A1
 MOVE.W #8000,D0
CAA
 MOVE.B (A0)+,(A1)+
 DBF D0,CAA
 JSR $72000
 RTS
MUSIC3
 BSR FIMU
 LEA MUSI3,A0
 LEA $70000,A1
 MOVE.W #$1146,D0
CAB
 MOVE.B (A0)+,(A1)+
 DBF D0,CAB
 MOVE.L #$70008,$4D6
 MOVEQ #1,D0
 JSR $70000
 RTS
FIMU
 CLR.L $4E2.W
 CLR.L $4DA.W
 CLR.L $4D6.W
 MOVE.L	#$FF8800,A0
 MOVE.L	#$8080000,(A0)
 MOVE.L	#$9090000,(A0)
 MOVE.L	#$A0A0000,(A0)
 RTS
PAL	DS.W 16
HAND 	DS.L 1
zero2	dc.w $0
build	dc.l $0,$0,$0,$0 
AREA	DS.L 1
HANDLE
 DS.L 1 
message2	DC.B "  "
	DC.B "HEY! THE DELIVERANCE PRESENTA A TODOS LOS USUARIOS DE 'ST ANTIGUOS',EL INCREIBLE,PERO CIERTO...NEW ROM! SI...AHORA EL PROGRAMA SOLO ESTA ESPERANDO A QUE INSERTES EL DISCO QUE NO TE FUNCIONABA "
 	DC.B "Y QUE PULSES UNA TECLA...NOTA:ES MUY IMPORTANTE QUE ESTE PROGRAMA ESTE EN UNA CARPETA AUTO,Y QUE SE EJECUTE ANTES QUE CUALQUIER OTRO PROGRAMA,PARA ELLO,EN UN DISCO LIBRE,CREAS UNA "
	DC.B "CARPETA AUTO Y LO METES ALLI,Y ASI FUNCIONA,TAMBIEN ES RECOMENDABLE QUE APAGES EL ORDENADOR ANTES DE EJECUTAR ESTE PROGRAMA,PUES ALGUNOS PROGRAMAS SOLO SE BORRAN CUANDO LO APAGAS (Y NO "
	DC.B "HACIENDO UN 'RESET',LOS PROGRAMAS 'AUTORESIDENTES').BUENO HASTA AQUI EL FUNCIONAMIENTO,AHORA SCROLL NORMAL...ESTE PROGRAMA FUE ESCRITO POR GAL Y MAS TARDE RETOCADO POR RED DEVIL PARA QUE "
	DC.B "FUNCIONA EN LOS 520 ST Y 1040 ST.THE DELIVERANCE ESTA COMPUESTO POR:ALEATUM SOFT,GAL,RED DEVIL.SI TE INTERESAN MENUS COMPACTOS DE THE DELIVERANCE LLAMA AL (96) 5218701 Y PREGUNTA POR ANDRES (RED DEVIL) "
	DC.B "ASI QUE YA SABEIS...PODEIS CAMBIAR DE MUSICA CON LAS TECLAS F1-F2-F3 Y DE HZ CON LA TECLA 0.ESPERO QUE ESTE PROGRAMA OS SEA UTIL."
	DC.B "AHORA ALGUNOS SALUDOS PARA GENTE QUE CONOCEMOS:ELECTRO SOFT(ESPECIALMENTE A RUNAWAY),SKYWALKERS,IVAN DE DONOSTI,DRAKE,GHOST,CARLOS (VILANOVA),JOSE (VIGO),CARLOS (BILBAO),ANTONIO (ELCHE),MIGUEL ANGEL (ZARAGOZA),"
	DC.B "Y,EN FIN,A TODOS LOS QUE ESTAN EN LA TIERRA DEL ST... BUENO ESTO ES TODO POR AHORA (12-SEPTIEMBRE-89)                                                 ADIOS"
	DC.B "                                      CUELGA                                                PESADO                                                                   -RESTART- (RE-EMPEZAR) ---<<<<THE DELIVERANCE>>>>>---"
	DC.B $FF,0	
SR_USER	DS.L 1
MYSP	DS.L 1
FONT	INCBIN 'FONT1.FNT',0  
PIC	INCBIN 'NEWROM.PI1',0
MUSI1 	INCBIN 'TEXMUS.BIN',0
MUSI2 	INCBIN 'MUSIC.TEX',0
MUSI3 	INCBIN 'MUSIC.BAL',0	







	
