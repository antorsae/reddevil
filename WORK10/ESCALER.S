** RUTINA DE ESCALER VERTICAL:
** FUNCIONA TANTO PARA AUMENTAR
** COMO PARA REDUCIR OBJETOS

** (C) 1990 RED DEVIL

	LEA PIC+34(PC),A0
	LEA FONT(PC),A1
	BSR DEPACK
	
MO	MOVE.W #$25,-(A7)
	TRAP #14
	ADDQ.L #2,A7
	LEA FONT(PC),A0
	LEA $F8000,A1
	ADDQ.W #1,IK
	MOVEQ #0,D1
	MOVE.W IK,D1
	MOVE.L #200,D0
	BSR.S ESCALE
	BRA.S MO
	CLR.L -(A7)
	TRAP #1
IK	DS.W 1
ESCALE	MOVEQ #0,D3
	ADDQ.W #1,D1
	MOVE.W D1,D4
	DIVU D1,D0
	SUBQ.W #2,D1
	MOVE.W D0,D3
	SWAP D0
	MOVEQ #0,D2
	MULU #160,D3
CLOP	LEA 0(A0,D3.W),A0
	ADD.W D0,D2
	CMP.W D2,D4
	BGT.S VAM
	SUB.W D4,D2
	LEA 160(A0),A0
VAM	BSR CLI
	DBF D1,CLOP
	RTS
CLI	MOVEQ #20-1,D7
D7LK	MOVE.L (A0)+,(A1)+
	MOVE.L (A0)+,(A1)+
	DBF D7,D7LK
	LEA -160(A0),A0
	RTS
DEPACK	MOVE.L #2,D0
	NEG.B D0
	MOVE.W	#$C7,D4		; 200 LINEAS
	CLR.W	D7
	CLR.B	D0
L30842	MOVE.L	A1,-(A7) 	; A1=DI PANTALLA
	MOVE.W	#3,D5
L30848	MOVE.L	A1,-(A7)
	MOVE.W	#$13,D6
L3084E	BSR.S	L3086E
	BSR.S	L3086E
	LEA	6(A1),A1
	DBF	D6,L3084E
	MOVEA.L	(A7)+,A1
	ADDQ.L	#2,A1
	DBF	D5,L30848
	MOVEA.L	(A7)+,A1
	LEA	$A0(A1),A1
	DBF	D4,L30842
	RTS
L3086E	SUBQ.B	#1,D0
	BPL	L30892
L30874	MOVE.B	(A0)+,D0
	CMPI.B	#$80,D0
	BEQ	L30874
	BTST	#7,D0
	BNE	L3088C
	CLR.W	D7
	BRA	L30892
L3088C	NEG.B	D0
	MOVE.W	#$FFFF,D7
L30892	TST.W	D7
	BNE	L3089C
	MOVE.B	(A0)+,(A1)+
	RTS
L3089C	MOVE.B	(A0),(A1)+
	TST.B	D0
	BNE.S NOSUM
	ADDQ.L	#1,A0
NOSUM	RTS
PIC	INCBIN 'C23.PC1'
FONT