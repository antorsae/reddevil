ALT	EQU 30

	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	LEA 6(A7),A7
	BSR CLS
	BSR STEXT
	BSR ROTY		 
ME	MOVE.W #$25,-(A7)
	TRAP #14
	LEA 2(A7),A7
	* MOVE.W #$700,$FFFF8240.W
	BSR SCLL
	MOVE.W #$777,$FFFF8240.W
	BRA.S ME
	CLR.L -(A7)
	TRAP #1
CTEXT	DC.L ZTEXT
VEL	EQU 2 ;(POSIBLES 1,2,4,8)
PAS	DC.W 7*4*(8-VEL)
SCLL	MOVEA.L CTEXT,A4
	MOVE.W PAS,D6
	MOVE.L (A4)+,A5
	LEA 0(A5,D6.W),A5
	MOVEA.L SCREEN,A6
	BSR PM1
	MOVE.L (A4)+,A5
	LEA 0(A5,D6.W),A5
	MOVEA.L SCREEN,A6
	BSR PO1
	MOVEQ #0,D0
	BSR LLEZ
	
	REPT 18
	ADDQ.W #8,D0
	BSR LLEZ
	ENDR
	
	ADDQ.W #8,D0
	MOVE.L (A4)+,A5
	LEA 0(A5,D6.W),A5
	MOVEA.L SCREEN,A6
	LEA 0(A6,D0.W),A6
	BSR PO19
	SUB.W #7*4*VEL,PAS
	BPL.S NO_VUL
	MOVE.W #7*4*(8-VEL),PAS
	ADDQ.L #4,CTEXT
	MOVE.L (A4),D6
	BNE.S NO_VUL
	MOVE.L #ZTEXT,CTEXT
NO_VUL	RTS 
LLEZ	MOVE.L (A4)+,A5
	LEA 0(A5,D6.W),A5
	MOVEA.L SCREEN,A6
	LEA 0(A6,D0.W),A6
	BSR PM
	MOVE.L (A4)+,A5
	LEA 0(A5,D6.W),A5
	ADDQ.W #8,A6
	BSR PO1
	RTS
PM	MOVEM.L (7*4*8)(A5),D1-D5/D7
	MOVE.W D1,8+(160*0)(A6)
	SWAP D1
	OR.W D1,(A6)
	MOVE.W D2,8+(160*1)(A6)
	SWAP D2
	OR.W D2,160*1(A6)
	MOVE.W D3,8+(160*2)(A6)
	SWAP D3
	OR.W D3,160*2(A6)
	MOVE.W D4,8+(160*3)(A6)
	SWAP D4
	OR.W D4,160*3(A6)
	MOVE.W D5,8+(160*4)(A6)
	SWAP D5
	OR.W D5,160*4(A6)
	MOVE.W D7,8+(160*5)(A6)
	SWAP D7
	OR.W D7,160*5(A6)
	MOVE.W (7*4*8)+(4*6)+2(A5),8+(160*6)(A6)
	MOVE.W (7*4*8)+(4*6)(A5),D7
	OR.W D7,160*6(A6)
	RTS	
PO1	MOVE.W (A5),D7
	OR.W D7,(A6)
	MOVE.W (4*1)(A5),D7
	OR.W D7,160*1(A6)
	MOVE.W (4*2)(A5),D7
	OR.W D7,160*2(A6)
	MOVE.W (4*3)(A5),D7
	OR.W D7,160*3(A6)
	MOVE.W (4*4)(A5),D7
	OR.W D7,160*4(A6)
	MOVE.W (4*5)(A5),D7
	OR.W D7,160*5(A6)
	MOVE.W (4*6)(A5),D7
	OR.W D7,160*6(A6)
	RTS
PO19	MOVE.W (2*0)+(7*4*8)(A5),D7
	OR.W D7,(A6)
	MOVE.W (2*2)+(7*4*8)(A5),D7
	OR.W D7,160*1(A6)
	MOVE.W (2*4)+(7*4*8)(A5),D7
	OR.W D7,160*2(A6)
	MOVE.W (2*6)+(7*4*8)(A5),D7
	OR.W D7,160*3(A6)
	MOVE.W (2*8)+(7*4*8)(A5),D7
	OR.W D7,160*4(A6)
	MOVE.W (2*10)+(7*4*8)(A5),D7
	OR.W D7,160*5(A6)
	MOVE.W (2*12)+(7*4*8)(A5),D7
	OR.W D7,160*6(A6)
	RTS
PM1	MOVE.W 2+(7*4*8)(A5),(A6)
	MOVE.W 2+(4*1)+(7*4*8)(A5),160*1(A6)
	MOVE.W 2+(4*2)+(7*4*8)(A5),160*2(A6)
	MOVE.W 2+(4*3)+(7*4*8)(A5),160*3(A6)
	MOVE.W 2+(4*4)+(7*4*8)(A5),160*4(A6)
	MOVE.W 2+(4*5)+(7*4*8)(A5),160*5(A6)
	MOVE.W 2+(4*6)+(7*4*8)(A5),160*6(A6)
	RTS	
CLS	LEA $F8000,A0
	MOVE.W #(32000/8)-1,D0
KKLL	CLR.L (A0)+
	CLR.L (A0)+
	DBF D0,KKLL
	RTS
ROTY	LEA SFONT,A6
	MOVE.W #80-1,D7
GETTL	BSR CLD
	MOVE.W #80-1,D0
	SUB.W D7,D0
	LEA FONT,A0
	LEA $F8000,A1
	BSR TODOL
	MOVE.W #16-1,D6
SALB	BSR SALVA
	BSR ROTA1
	DBF D6,SALB
	DBF D7,GETTL
	RTS
CLD	LEA $F8000,A0
	CLR.W (A0)
	CLR.W 160*1(A0)
	CLR.W 160*2(A0)
	CLR.W 160*3(A0)
	CLR.W 160*4(A0)
	CLR.W 160*5(A0)
	CLR.W 160*6(A0)
	CLR.W 8(A0)
	CLR.W 8+(160*1)(A0)
	CLR.W 8+(160*2)(A0)
	CLR.W 8+(160*3)(A0)
	CLR.W 8+(160*4)(A0)
	CLR.W 8+(160*5)(A0)
	CLR.W 8+(160*6)(A0)
	RTS
SALVA	LEA $F8000,A0
	MOVE.W (A0),(A6)+
	MOVE.W 8(A0),(A6)+
	MOVE.W 160*1(A0),(A6)+
	MOVE.W 8+(160*1)(A0),(A6)+
	MOVE.W 160*2(A0),(A6)+
	MOVE.W 8+(160*2)(A0),(A6)+
	MOVE.W 160*3(A0),(A6)+
	MOVE.W 8+(160*3)(A0),(A6)+
	MOVE.W 160*4(A0),(A6)+
	MOVE.W 8+(160*4)(A0),(A6)+
	MOVE.W 160*5(A0),(A6)+
	MOVE.W 8+(160*5)(A0),(A6)+
	MOVE.W 160*6(A0),(A6)+
	MOVE.W 8+(160*6)(A0),(A6)+
	RTS
ROTA1	LEA $F8000,A0
	MOVE.W #0,CCR
	ROXR (A0)
	ROXR 8(A0)
	ROXR 160(A0)
	ROXR 8+160(A0)
	ROXR 160*2(A0)
	ROXR 8+(160*2)(A0)
	ROXR 160*3(A0)
	ROXR 8+(160*3)(A0)
	ROXR 160*4(A0)
	ROXR 8+(160*4)(A0)
	ROXR 160*5(A0)
	ROXR 8+(160*5)(A0)
	ROXR 160*6(A0)
	ROXR 8+(160*6)(A0)
	RTS
TODOL	MULU #8,D0
	LEA 0(A0,D0.W),A0
COPA	MOVE.B (A0)+,(A1)
	MOVE.B (A0)+,160*1(A1)
	MOVE.B (A0)+,160*2(A1)
	MOVE.B (A0)+,160*3(A1)
	MOVE.B (A0)+,160*4(A1)
	MOVE.B (A0)+,160*5(A1)
	MOVE.B (A0)+,160*6(A1)
	MOVE.B (A0)+,160*7(A1)
	RTS
STEXT	LEA TEXT,A0
	LEA ZTEXT,A1
TERR	MOVEQ #0,D0
	MOVE.B (A0)+,D0
	BEQ.S YAUNEG
	BSR SSER
	MULU #7*4*16,D0
	ADD.L #SFONT,D0
	MOVE.L D0,(A1)+
	BRA.S TERR
YAUNEG	CLR.L (A1)
	RTS
SSER	LEA CH,A2
	MOVEQ #-1,D1
SCLOP	MOVE.B (A2)+,D2
	BMI.S NFOUND
	ADDQ.W #1,D1
	CMP.B D0,D2
	BNE.S SCLOP
NFOUND	MOVEQ #0,D0
	MOVE.W D1,D0
	RTS
CH	DC.B "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789:!. \_+-=?(),'",'"',-1  
BASURA	DS.L 16
SCREE	DS.L 1
CDC	DS.W 1
TEXT	DC.B '                                           '
	DC.B 'HOLA HETE AQUI... ESTE ES MI NUEVO SCROLLER ESTA VEZ DE 8 POR 8 '
	DC.B 'Y SOPORTANDO DE PRIMERAS VARIOS CARACTERES COMO:.?,_\()! Y SIMILARES '
	DC.B 'TRABAJA SOLO CON A4-A6\D6-D7, POR LO QUE PUEDE SER UTIL PARA LAS DIGI-DEMOS '
	DC.B 'LA VELOCIDAD SE AUMENTA FACILMENTE CON VEL... BUENO, ESTO ES TODO, UN SALUDO DE '
	DC.B 'RED DEVIL!'
	DC.B '                                           '
	DC.B 0
ZTEXT	DS.L (ZTEXT-TEXT)
SCREEN	DC.L $F8000
FONT	INCBIN 'FONT8P2.RED'
SFONT	DS.W 1



	
	


	
  