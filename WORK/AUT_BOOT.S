	PEA INIT
	MOVE.W #9,-(A7)
	TRAP #1
	ADDA.L #6,A7
	
AGAIN	PEA EXT0
	MOVE.W #9,-(A7)
	TRAP #1
	ADDA.L #6,A7
	MOVE.W #7,-(A7)
	TRAP #1
	ADDA.L #2,A7
	MOVE.W #1,-(A7)
	MOVE.W #0,-(A7)
	MOVE.W #0,-(A7)
	MOVE.W #1,-(A7)
	MOVE.W #0,-(A7)
	MOVE.L #0,-(A7)
	MOVE.L #BUFF2,-(A7)
	MOVE.W #8,-(A7)
	TRAP #14
	ADDA.L #20,A7	
	MOVE.W #$6038,BUFF
	LEA BUFF+2,A1
	LEA INDEX,A0
	MOVE.L (A0)+,(A1)+
	MOVE.W (A0)+,(A1)+
	LEA BUFF2+8,A0
	LEA BUFF+8,A1
	MOVE.W #27-1-6,D0
COPIA	MOVE.B (A0)+,(A1)+
	DBF D0,COPIA
	LEA BUFF+$38+2,A1
	LEA CODE,A0
	LEA CODE,A3
COP	MOVE.B (A0)+,(A1)+	
	CMPA.L A1,A3
	BNE COP
	LEA BUFF,A0
	CLR.L D0	
	MOVE.W #(510/2)-1,D3
BUC	MOVE.W (A0)+,D1
	ADD.W D1,D0
	DBF D3,BUC
	MOVE.W #$1234,D1
	SUB.W D0,D1
	MOVE.W D1,CODE-2
	MOVE.W #1,-(A7)
	MOVE.W #0,-(A7)
	MOVE.W #0,-(A7)
	MOVE.W #1,-(A7)
	MOVE.W #0,-(A7)
	MOVE.L #0,-(A7)
	MOVE.L #BUFF,-(A7)
	MOVE.W #9,-(A7)
	TRAP #14
	ADDA.L #20,A7
	BRA AGAIN
	
BUFF	DS.B 512
	
CODE	* CMP.L #$31415926,$426
	TST.L $42A
	BNE VIRUS
SIGUE	PEA TEXT(PC)
	MOVE.W #9,-(SP)
	TRAP #1
	ADDA.L #6,SP
	RTS
VIRUS	PEA TEXT1(PC)
	MOVE.W #9,-(A7)
	TRAP #1
	ADDA.L #6,A7
	CLR.W $FFFF8240.W
GOTO	EOR.W #$700,$FFFF8240.W
	MOVE.W #$17,D0
RET	DBF D0,RET
	BRA GOTO
TEXT1	DC.B "There is a virus in memory,please turn",$A,$D
	DC.B "        off and restart...",$A,$D,0	 
TEXT2	DC.B 27,"E",0
TEXT	DC.B "         RED DEVIL BOOT-SECTOR",$a,$d
	dc.b 0,0
FIN
INDEX	DC.B 'RED!  '
BUFF2	DS.B 512
EXT0	DC.B "METE EL DISCO "
EXT1	DC.B "METE DISCO ",$A,$D,$A,$D,0
INIT	DC.B "HOLA, ESTE PROGRAMA SIRVE PARA",$A,$D
	DC.B "INSERTAR UN ANTIVIRUS EN UN",$A,$D 
	DC.B "DISCO (SIEMPRE QUE SEA POR",$A,$D
	DC.B "FICHEROS).",$A,$D,$A,$D,0              
